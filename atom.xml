<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Kevin Hu&#39;s Blog</title>
  
  <subtitle>A Hungry Fool</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.kevinhu.me/"/>
  <updated>2018-10-22T07:14:17.793Z</updated>
  <id>https://blog.kevinhu.me/</id>
  
  <author>
    <name>Kevin Hu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Paper Reading 10-22 Dapper, a Large-Scale Distributed Systems Tracing infrastructure</title>
    <link href="https://blog.kevinhu.me/2018/10/22/Paper-Reading-10-22-Dapper-a-Large-Scale-Distributed-Systems-Tracing-infrastructure/"/>
    <id>https://blog.kevinhu.me/2018/10/22/Paper-Reading-10-22-Dapper-a-Large-Scale-Distributed-Systems-Tracing-infrastructure/</id>
    <published>2018-10-22T06:24:08.000Z</published>
    <updated>2018-10-22T07:14:17.793Z</updated>
    
    <content type="html"><![CDATA[<p>Link: <a href="https://ai.google/research/pubs/pub36356" target="_blank" rel="noopener">https://ai.google/research/pubs/pub36356</a></p><p>This is a 2010 paper that presents Dapper, a tracing infrastructure from Google,to solve problems at Google scale, in its massive scale distributed systems,where a service could invoke very deep RPC calls across different nodes in thecluster, which makes tracing quite challenging.</p><a id="more"></a><p>Highlights and takeaways:</p><h2 id="Design"><a href="#Design" class="headerlink" title="Design"></a>Design</h2><p>The paper introduces the following concepts to describe the system:<code>tree</code>, <code>span</code>, and <code>annotation</code>.</p><h3 id="tree"><a href="#tree" class="headerlink" title="tree"></a><code>tree</code></h3><p><img src="figure1.png" alt="Figure1"></p><p>A simple service call could span a few different nodes in the system,forming a calling tree between different services, as shown abovein figure1.</p><h3 id="span"><a href="#span" class="headerlink" title="span"></a><code>span</code></h3><p><img src="figure2.png" alt="Figure2"></p><p>In Dapper trace tree, the tree nodes are basic units of work which isreferred to as <code>spans</code>. The edge indicates a casual relationship a spanand a parent. See figure2.</p><p>Each trace has a single trace id across all its children spans.Each span has one id, and records the relationships between parentand child. See figure2.Parent spans always starts before child and ends after children finish.</p><p>Dapper is designed to follow distributed control paths with near-zerointervention from the application developers, by instrumenting thefollowing libraries:</p><ul><li>thread library: Dapper attaches a trace context to thread-localstorage.</li><li>asynchronous control flow library: Dapper instruments the control flow library to ensureall async callbacks store the context of their creator.</li><li>IPC library: All Google’s inter-process communication is built arounda single RPC framework, for all communications on same machine,and across network.</li></ul><h3 id="annotation"><a href="#annotation" class="headerlink" title="annotation"></a><code>annotation</code></h3><p>The instrumentation above is sufficient to derive traces of complexdistributed systems and made transparent to users, but Dapper alsoprovides capabilities for users to annotate important sections totheir applications.</p><h2 id="Sampling"><a href="#Sampling" class="headerlink" title="Sampling"></a>Sampling</h2><p>To improve performance, one of Dapper’s design decision is sampling. Dapper team noticed that Samplingat a relative small rate can get pretty good results with insightsto critical performance issues.</p><h2 id="Trace-collection"><a href="#Trace-collection" class="headerlink" title="Trace collection"></a>Trace collection</h2><p>Trace collection is divided to the following steps:</p><ul><li>Dapper span data is written to local log files.</li><li>Local logs are collected by Dapper daemons.</li><li>And are finally written to Bigtable.</li><li>User can query and analyze different traces with a Dapper webinterface, which aggregates all logs and sort by tracing ids.</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Link: &lt;a href=&quot;https://ai.google/research/pubs/pub36356&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://ai.google/research/pubs/pub36356&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This is a 2010 paper that presents Dapper, a tracing infrastructure from Google,
to solve problems at Google scale, in its massive scale distributed systems,
where a service could invoke very deep RPC calls across different nodes in the
cluster, which makes tracing quite challenging.&lt;/p&gt;
    
    </summary>
    
      <category term="Paper" scheme="https://blog.kevinhu.me/categories/Paper/"/>
    
    
      <category term="distributed systems" scheme="https://blog.kevinhu.me/tags/distributed-systems/"/>
    
      <category term="tracing" scheme="https://blog.kevinhu.me/tags/tracing/"/>
    
  </entry>
  
  <entry>
    <title>Paper Reading: A Reconfigurable Fabric for Accelerating Large-Scale Datacenter Services</title>
    <link href="https://blog.kevinhu.me/2018/10/14/14-Paper-Reading-2-Catapult/"/>
    <id>https://blog.kevinhu.me/2018/10/14/14-Paper-Reading-2-Catapult/</id>
    <published>2018-10-15T02:47:00.000Z</published>
    <updated>2018-10-15T16:30:21.809Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.microsoft.com/en-us/research/publication/a-reconfigurable-fabric-for-accelerating-large-scale-datacenter-services/" target="_blank" rel="noopener">https://www.microsoft.com/en-us/research/publication/a-reconfigurable-fabric-for-accelerating-large-scale-datacenter-services/</a></p><p>This is one of the series of papers from Microsoft’s <a href="https://www.microsoft.com/en-us/research/project/project-catapult/" target="_blank" rel="noopener">Project Catapult</a>,which studies leveraging reconfigurable devices (FPGA, etc.) to accelerate data center, from very specificaccelerating algorithms like page ranking for Bing search engine, to more sophisticated machinelearning frameworks like DNN.</p><p>This is one of their early publications, which introduces the basic design and implementationof the FPGA accelerated datacenter. It covers the very fundamental details of all aspects ofserver design, from hardware, network topology, FPGA core design, fault-tolerant cluster managementsoftware design, workload scheduling algorithm, and etc..</p><a id="more"></a><p>Some highlights and takeaways:</p><h2 id="Hardware"><a href="#Hardware" class="headerlink" title="Hardware"></a>Hardware</h2><p>Catapult hardware is integrated with existing server-grade blades, which takes the space on thePCIe of the motherboard, through a daughter board with one single high-end FPGA card.</p><h2 id="Network-Design"><a href="#Network-Design" class="headerlink" title="Network Design"></a>Network Design</h2><p>The daughter-boardcards connects each other with a fast secondary network, independent of the CPU network. The secondarynetworks form a 6x8 torus topology network (see more details in paper), which gives fast inter-FPGA communications,good routability but not too much cabling complexity. The CPU network connects to a 48-port switch foreach pod.</p><h2 id="Software-Interface"><a href="#Software-Interface" class="headerlink" title="Software Interface"></a>Software Interface</h2><p>On FPGA space has been divided into <em>Shell</em> and <em>Role</em>. <em>Shell</em> manages the common libraries or functionalitieslike memory management, serial link, or PCIe, reconfiguration logics, etc.. The <em>Role</em> space is responsible foractual acceleration algorithm, which will be reloaded for each reconfiguration when the FPGA functionality needsto be updated.</p><p>FPGAs will be reconfigured from time to time and certain software must be designed to ensure to take the FPGAcompletely offline and ignored by neighbors, to ensure correct operations.</p><p>Debugging might be hard to achieve through typical JTAG hardware debugging facilities, considering the scaleof the datacenter. The paper presents an ‘always-on’ data collector that captures the key components andsaves them to a circular-buffer log.</p><p>The software interfaces divides the algorithm into 7-stages and distributed them to a 8-node FPGA group, withone for redundancy. The paper describes how the network accelerates the ‘Feature Extraction’, which producesa single score at the last stage, indicating how close the document is to the search key word.</p><p>All the queries are queued in memory in DRAM. The Queue Manager takes documents from each queue, then sends themdown the pipeline. It also manages the model reloads in the pipeline, which calculates different feature ‘scores’ forqueries.</p><h2 id="Evaluation"><a href="#Evaluation" class="headerlink" title="Evaluation"></a>Evaluation</h2><p>The Catapult project, according to the paper, ‘reduces the worst-case latency by 29% in the 95 percentile distribution’in their evaluation environment, and provides 95% gain in throughput relative to software.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://www.microsoft.com/en-us/research/publication/a-reconfigurable-fabric-for-accelerating-large-scale-datacenter-services/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.microsoft.com/en-us/research/publication/a-reconfigurable-fabric-for-accelerating-large-scale-datacenter-services/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This is one of the series of papers from Microsoft’s &lt;a href=&quot;https://www.microsoft.com/en-us/research/project/project-catapult/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Project Catapult&lt;/a&gt;,
which studies leveraging reconfigurable devices (FPGA, etc.) to accelerate data center, from very specific
accelerating algorithms like page ranking for Bing search engine, to more sophisticated machine
learning frameworks like DNN.&lt;/p&gt;
&lt;p&gt;This is one of their early publications, which introduces the basic design and implementation
of the FPGA accelerated datacenter. It covers the very fundamental details of all aspects of
server design, from hardware, network topology, FPGA core design, fault-tolerant cluster management
software design, workload scheduling algorithm, and etc..&lt;/p&gt;
    
    </summary>
    
      <category term="Paper" scheme="https://blog.kevinhu.me/categories/Paper/"/>
    
    
      <category term="FPGA" scheme="https://blog.kevinhu.me/tags/FPGA/"/>
    
      <category term="Datacenter" scheme="https://blog.kevinhu.me/tags/Datacenter/"/>
    
      <category term="HPC" scheme="https://blog.kevinhu.me/tags/HPC/"/>
    
  </entry>
  
  <entry>
    <title>Reading-Summary 2018-10-14</title>
    <link href="https://blog.kevinhu.me/2018/10/14/14-Reading-Summary-2018-10/"/>
    <id>https://blog.kevinhu.me/2018/10/14/14-Reading-Summary-2018-10/</id>
    <published>2018-10-14T20:52:00.000Z</published>
    <updated>2018-10-14T21:28:08.249Z</updated>
    
    <content type="html"><![CDATA[<p>Posts I find interesting around the web:</p><h2 id="Miscalleneous-Posts"><a href="#Miscalleneous-Posts" class="headerlink" title="Miscalleneous Posts"></a>Miscalleneous Posts</h2><h3 id="Augumenting-Long-term-Memory"><a href="#Augumenting-Long-term-Memory" class="headerlink" title="Augumenting Long-term Memory"></a><a href="http://augmentingcognition.com/ltm.html" target="_blank" rel="noopener">Augumenting Long-term Memory</a></h3><p>A very interesting posts on augumenting long-term memory, based on Ebbinghaus’ forgetting curve theory: use flashcards to memorize everything you’ve learned, and even trivias like your friends’ birthday, etc.. It uses Anki flashcard software to go through the list of stuff.</p><p>Author also reasoned about the benefits of memorizing all the details, concepts, and “everything”: the details are the building blocks of a field of knowledge, and memorizing them dramatically helps the understanding this field.</p><p>It’s a long read but a deep discussion, and I find it a joyful read.</p><h3 id="How-To-Get-Rich"><a href="#How-To-Get-Rich" class="headerlink" title="How To Get Rich"></a><a href="https://www.edge.org/conversation/jared_diamond-how-to-get-rich" target="_blank" rel="noopener">How To Get Rich</a></h3><p>An interesting talk from Jared Diamond, the author of <em>Guns, Germs, and Steel</em>. Despite the kind of misleading title, it’s an interesting take on history and the progress of human civilizations, and how competitions between civilizations influence their prosperity.</p><h2 id="Systems-Design-and-Distributed-Systems"><a href="#Systems-Design-and-Distributed-Systems" class="headerlink" title="Systems Design and Distributed Systems"></a>Systems Design and Distributed Systems</h2><h3 id="SoftwareArch-You-are-going-to-need-it-—-Using-Interfaces-and-Dependency-Injection-to-future-proof-your-designs"><a href="#SoftwareArch-You-are-going-to-need-it-—-Using-Interfaces-and-Dependency-Injection-to-future-proof-your-designs" class="headerlink" title="SoftwareArch: You are going to need it — Using Interfaces and Dependency Injection to future proof your designs"></a><a href="https://medium.com/dm03514-tech-blog/you-are-going-to-need-it-using-interfaces-and-dependency-injection-to-future-proof-your-designs-2cf6f58db192" target="_blank" rel="noopener">SoftwareArch: You are going to need it — Using Interfaces and Dependency Injection to future proof your designs</a></h3><p>An introduction to interfaces in Golang, and how dependency injection can help you design large projects.</p><h3 id="System-Design-Primer"><a href="#System-Design-Primer" class="headerlink" title="System Design Primer"></a><a href="https://github.com/donnemartin/system-design-primer" target="_blank" rel="noopener">System Design Primer</a></h3><p>The basic concepts of system design, web design, basic principals and distributed systems design. A collaborated effort on Github.</p><h3 id="Distributed-Periodic-Scheduling-with-Cron"><a href="#Distributed-Periodic-Scheduling-with-Cron" class="headerlink" title="Distributed Periodic Scheduling with Cron"></a><a href="https://landing.google.com/sre/book/chapters/distributed-periodic-scheduling.html" target="_blank" rel="noopener">Distributed Periodic Scheduling with Cron</a></h3><p>A chapter from Google’s new Site Reliability Engineering book, on how to design a distributed cron job daemon, and handle problems including fault-tolerance, repeatedly scheduled jobs, overloading the cluster, etc.. The whole book is a very valuable summary of experience of automation and distributed systems design at Google, and at Google scale. Definitely will read through other chapters.</p><h3 id="Go-hits-the-concurrency-nail-right-on-the-head"><a href="#Go-hits-the-concurrency-nail-right-on-the-head" class="headerlink" title="Go hits the concurrency nail right on the head"></a><a href="https://eli.thegreenplace.net/2018/go-hits-the-concurrency-nail-right-on-the-head/" target="_blank" rel="noopener">Go hits the concurrency nail right on the head</a></h3><p>Eli Bendersky’s blog post on why Golang gracefully handles the problems of concurrency at language level, that other major languages handles rather awkwardly.</p><ul><li>Use goroutine to unify the interface to coroutines and thread.</li><li>Use channels to enforce the ‘share memory by communicating’ pattern.</li></ul><p>Which greatly reduces the programmer’s mental burden of design highly concurrent systems.</p><h3 id="Getting-started-with-Python-in-HPC"><a href="#Getting-started-with-Python-in-HPC" class="headerlink" title="Getting started with Python in HPC"></a><a href="http://andy.terrel.us/blog/2012/09/27/starting-with-python/" target="_blank" rel="noopener">Getting started with Python in HPC</a></h3><p>An introduction to learning Python in HPC, from introduction to Python language, to distributed HPC frameworks for Python.</p><h3 id="A-Whirlwind-Tour-of-Distributed-Systems"><a href="#A-Whirlwind-Tour-of-Distributed-Systems" class="headerlink" title="A Whirlwind Tour of Distributed Systems"></a><a href="https://medium.com/@marinsmiljanic/a-whirlwind-tour-of-distributed-systems-918d6632eb78" target="_blank" rel="noopener">A Whirlwind Tour of Distributed Systems</a></h3><p>A list of concepts, papers, and interesting blog posts on distributed systems design.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Posts I find interesting around the web:&lt;/p&gt;
&lt;h2 id=&quot;Miscalleneous-Posts&quot;&gt;&lt;a href=&quot;#Miscalleneous-Posts&quot; class=&quot;headerlink&quot; title=&quot;Miscal
      
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
      <category term="systems" scheme="https://blog.kevinhu.me/tags/systems/"/>
    
  </entry>
  
  <entry>
    <title>Weekly paper reading: C++ and the Perils of Double-Checked Locking</title>
    <link href="https://blog.kevinhu.me/2018/09/09/Weekly-Paper-Reading-1-DCLP/"/>
    <id>https://blog.kevinhu.me/2018/09/09/Weekly-Paper-Reading-1-DCLP/</id>
    <published>2018-09-09T18:03:20.000Z</published>
    <updated>2018-10-22T06:27:34.050Z</updated>
    
    <content type="html"><![CDATA[<p>An interesting paper on the perils of C++, design pattern and multi-threading when they’re mixed together:</p><p><a href="http://www.aristeia.com/Papers/DDJ_Jul_Aug_2004_revised.pdf" target="_blank" rel="noopener">C++ and the Perils of Double-Checked Locking</a></p><p>The DCLP(Double-Checked Locking Pattern) is often-used in singleton design pattern: you’d like to initialize a shared object for singleton pattern, you follow the steps:</p><ul><li>check lock if the resource is already initialized</li><li>if no, lock the mutex</li><li>check again if the resource is locked inside the mutex-protected area.</li><li>and again if no, initialize the object</li></ul><p>See C++ example:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Singleton* Singleton::instance() &#123;</span><br><span class="line">  if (pInstance == 0) &#123;              // 1st check, to avoid locking every time</span><br><span class="line">    Lock lock;</span><br><span class="line"></span><br><span class="line">    if (pInstance == 0) &#123;            // 2nd check, a safe check to guarantee correctness</span><br><span class="line">      pInstance = new Singleton;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return pInstance</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>This pattern however, introduces subtle bugs when described in C++ with multi-threading.</p><p>The issue is with this statement:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pInstance = new Singleton;</span><br></pre></td></tr></table></figure><p>The following steps happen:</p><ol><li>Allocate memory for the object</li><li>Construct an object in the allocated memory.</li><li>Assign <code>pInstance</code> to the allocated memory.</li></ol><p>But C++ specification don’t enforce the steps happen in order, and compilers are therefore not constrained to reorder them for sake of optimization. As long as the observable outcome of the instructions are correct, compilers are free to place instructions in an order so that CPUs are most utilized. Consider the following case with DCLP:</p><ul><li>Thread A execute the DCLP piece of code for the first time, performs the 1st check, lock the mutex, performs the 2nd check, allocates memory for Singleton object, points the pInstance to the allocated memory. But before the Singleton object is constructed, thread A is suspended or another thread is scheduled at the same time.</li><li>Thread B enters DCLP area, determines that <code>pInstance</code> is non-null, and start using the object even before it’s fully constructed, and start accessing the <code>Singleton</code> object.</li></ul><p>Oops. This is a very subtle bug, and hard to detect issue when we’re trying to initialize a shared resource once.</p><p>The paper digs into details on how compiler can leverage all sorts of different optimizations to spoil you effort to correct the DCLP code, and how to actually implement it correctly with <code>volatile</code> keyword.</p><p>It’s a very interesting paper on algorithm, C++, and programming, It makes you stand in awe of the difficulty and intricacies of C++ and multi-threaded programming.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;An interesting paper on the perils of C++, design pattern and multi-threading when they’re mixed together:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.ari
      
    
    </summary>
    
      <category term="Paper" scheme="https://blog.kevinhu.me/categories/Paper/"/>
    
    
      <category term="Programming" scheme="https://blog.kevinhu.me/tags/Programming/"/>
    
      <category term="C++" scheme="https://blog.kevinhu.me/tags/C/"/>
    
      <category term="Multithread" scheme="https://blog.kevinhu.me/tags/Multithread/"/>
    
      <category term="WeeklyPaper" scheme="https://blog.kevinhu.me/tags/WeeklyPaper/"/>
    
  </entry>
  
  <entry>
    <title>Reading-Summary 2018-06</title>
    <link href="https://blog.kevinhu.me/2018/07/09/09-2018-07-09-Reading-Summary/"/>
    <id>https://blog.kevinhu.me/2018/07/09/09-2018-07-09-Reading-Summary/</id>
    <published>2018-07-09T05:04:23.000Z</published>
    <updated>2018-07-09T05:28:24.799Z</updated>
    
    <content type="html"><![CDATA[<p>Posts I found interesting around the web:</p><h3 id="man7-Linux-cgroups"><a href="#man7-Linux-cgroups" class="headerlink" title="man7 Linux cgroups"></a><a href="http://man7.org/linux/man-pages/man7/cgroups.7.html" target="_blank" rel="noopener">man7 Linux cgroups</a></h3><p>Linux manual page to cgroups feature in the kernel, which restricts Linux processes CPU, max process numbers, memory usage, network setup and etc..</p><h3 id="man7-Linux-namespaces"><a href="#man7-Linux-namespaces" class="headerlink" title="man7 Linux namespaces"></a><a href="http://man7.org/linux/man-pages/man7/namespaces.7.html" target="_blank" rel="noopener">man7 Linux namespaces</a></h3><p>Linux manual page to namespaces feature in the kernel. Namespaces can be specified by the <code>clone</code> syscall, and isolates the child process’ cgroup, IPC, network, mount, domain names, and etc..</p><h3 id="GOTO-2018-Containers-From-Scratch"><a href="#GOTO-2018-Containers-From-Scratch" class="headerlink" title="GOTO 2018 Containers From Scratch"></a><a href="https://www.youtube.com/watch?v=8fi7uSYlOdc" target="_blank" rel="noopener">GOTO 2018 Containers From Scratch</a></h3><p>When all the ingredients come together, it’s the foundation where Docker is built upon. This very interesting talk from GOTO2018 demonstrates how you can use the following technologies already built-in the Linux kernel to create your own very small proof-of-concept docker:</p><ul><li><code>chroot</code></li><li><code>namespace</code></li><li><code>cgroups</code></li></ul><p>It also includes very interesting details including (but not limited to):</p><ul><li>You’ll need to mount the <code>/proc</code> virtual file systems for your ‘containerized’ child process.</li><li>You’ll need to provide ‘UnshareFlag’ <code>CLONE_NEWNS</code> to the <code>clone</code> system call, to ‘unshare’ the mount point from the child process from the parent process, so that parent doesn’t see child’s mount points (which could be many and messy).</li></ul><h3 id="A-Classical-Math-Problem-Gets-Pulled-Into-the-Modern-World"><a href="#A-Classical-Math-Problem-Gets-Pulled-Into-the-Modern-World" class="headerlink" title="A Classical Math Problem Gets Pulled Into the Modern World"></a><a href="https://www.quantamagazine.org/a-classical-math-problem-gets-pulled-into-the-modern-world-20180523/" target="_blank" rel="noopener">A Classical Math Problem Gets Pulled Into the Modern World</a></h3><p>An optimization problem is being used in AI, and therefore all AI applications, including self-driving, etc. Math is magical.</p><h3 id="Wikipedia-is-fixing-one-of-Internet’s-biggest-flaws"><a href="#Wikipedia-is-fixing-one-of-Internet’s-biggest-flaws" class="headerlink" title="Wikipedia is fixing one of Internet’s biggest flaws"></a><a href="https://www.washingtonpost.com/news/wonk/wp/2016/10/25/somethings-terribly-wrong-with-the-internet-and-wikipedia-might-be-able-to-fix-it/?utm_term=.9594628c76ca" target="_blank" rel="noopener">Wikipedia is fixing one of Internet’s biggest flaws</a></h3><p>As it actually encourages collaborations, discussions, and exposure to opposing views.</p><h3 id="Golang-Patterns-Part-2"><a href="#Golang-Patterns-Part-2" class="headerlink" title="Golang Patterns - Part 2"></a><a href="https://dev.to/napicellatwit/golang-patterns---part-2-1906" target="_blank" rel="noopener">Golang Patterns - Part 2</a></h3><h3 id="Technical-Writing-Learning-from-Kernighan"><a href="#Technical-Writing-Learning-from-Kernighan" class="headerlink" title="Technical Writing: Learning from Kernighan"></a><a href="https://two-wrongs.com/technical-writing-learning-from-kernighan.html" target="_blank" rel="noopener">Technical Writing: Learning from Kernighan</a></h3><p>Learning technical writing from the author of your favorite C programming book, ‘The C Programming Language’.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Posts I found interesting around the web:&lt;/p&gt;
&lt;h3 id=&quot;man7-Linux-cgroups&quot;&gt;&lt;a href=&quot;#man7-Linux-cgroups&quot; class=&quot;headerlink&quot; title=&quot;man7 Li
      
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
      <category term="Linux" scheme="https://blog.kevinhu.me/tags/Linux/"/>
    
      <category term="Docker" scheme="https://blog.kevinhu.me/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>A Note on Linux Hugepages</title>
    <link href="https://blog.kevinhu.me/2018/07/01/01-Linux-Hugepages/"/>
    <id>https://blog.kevinhu.me/2018/07/01/01-Linux-Hugepages/</id>
    <published>2018-07-01T23:30:20.000Z</published>
    <updated>2018-07-02T00:57:58.976Z</updated>
    
    <content type="html"><![CDATA[<p>Page table is where Linux stores virtual to physical page address translation, and its size can get huge when memory usage is high. One way to reduce the size of page tables, and reduce the number of page faults, is to use huge pages. I’ve been digging some information on hugepages for my own curiosity, and it looks like Linux has pretty good support for huge pages. And this blog serves as a quick note on my readings.</p><a id="more"></a><h2 id="Hugepages"><a href="#Hugepages" class="headerlink" title="Hugepages"></a>Hugepages</h2><p>The sysctl directory contains <code>/sys/kernel/mm/hugepages/hugepages-{pagesize}kB/</code> control files and information on hugepages, where pagesize could be 1048576 or 2048, corresponding to 1GB or 2MB of hugepage size.</p><p>To get information on hugepages on your Linux systems, the <code>hugepages</code> directory contains the controlling files:</p><ul><li><code>nr_hugepages</code></li><li><code>nr_hugepages_mempolicy</code></li><li><code>nr_overcommit_hugepages</code></li><li><code>free_hugepages</code></li><li><code>resv_hugepages</code></li><li><code>surplus_hugepages</code>.</li></ul><p>You can also get hugepage-related information from <code>/proc/meminfo</code>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HugePages_Total:    2048</span><br><span class="line">HugePages_Free:        0</span><br><span class="line">HugePages_Rsvd:        0</span><br><span class="line">HugePages_Surp:        0</span><br><span class="line">Hugepagesize:       2048 kB</span><br></pre></td></tr></table></figure><p>The <a href="https://www.kernel.org/doc/Documentation/vm/hugetlbpage.txt" target="_blank" rel="noopener">Kernel Documentation of Hugetlbpage</a> contains the detailed information and explanation of the purpose and usage of hugepage files, as well as <code>meminfo</code> fields.</p><h2 id="Allocating-Hugepages"><a href="#Allocating-Hugepages" class="headerlink" title="Allocating Hugepages"></a>Allocating Hugepages</h2><p>The most convenient way to reserve hugepages on x86_64 Linux is to echo into the sysctl file <code>/sys/kernel/mm/hugepages/hugepages-2048kB/nr_hugepages</code>, e.g.:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># echo 1024 &gt; /sys/kernel/mm/hugepages/hugepages-2048kB/nr_hugepages</span><br></pre></td></tr></table></figure><p>And for user to access and use the huge pages, Linux actually provides a quite convenient interface: the <code>hugetlbfs</code> file system, e.g.:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t hugetlbfs nodev /mnt/huge</span><br></pre></td></tr></table></figure><p>Which mounts a pseudo filesystem of type <code>hugetlbfs</code> on <code>/mnt/huge</code>, and uses the default huge pagesize specified by the system, and all files created inside the directory uses huge pages.</p><p>And after that, you can use hugepage-backed memory by creating files inside <code>/mnt/huge</code> directory. See example in Linux source tree: <a href="https://github.com/torvalds/linux/blob/master/tools/testing/selftests/vm/hugepage-mmap.c" target="_blank" rel="noopener">hugepage-mmap.c</a>. The author takes the following steps:</p><ul><li>Open a file inside <code>/mnt</code> with read-write permission.</li><li>Map memory to the file using <code>mmap</code>, with proper protection and flags set (<code>PROT_READ | PROR_WRITE</code> and <code>MAP_SHARED</code> in this case).</li><li>Use the hugepage-backed memory as usual.</li><li>Clean up memory and file.</li></ul><h2 id="Enable-Hugepage-On-Start"><a href="#Enable-Hugepage-On-Start" class="headerlink" title="Enable Hugepage On Start"></a>Enable Hugepage On Start</h2><p>According to Linux <a href="https://www.kernel.org/doc/Documentation/vm/hugetlbpage.txt" target="_blank" rel="noopener">Kernel Documentation</a>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">System administrators may want to put this command in one of the local rc</span><br><span class="line">init files.  This will enable the kernel to allocate huge pages early in</span><br><span class="line">the boot process when the possibility of getting physical contiguous pages</span><br><span class="line">is still very high.</span><br></pre></td></tr></table></figure><p>And to quote the <a href="https://lwn.net/Articles/376606/" target="_blank" rel="noopener">LWN article</a>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">If the huge page pool is statically allocated at boot-time, then this section</span><br><span class="line">will not be relevant as the huge pages are guaranteed to exist. In the event</span><br><span class="line">the system needs to dynamically allocate huge pages throughout its lifetime,</span><br><span class="line">then external fragmentation may be a problem.</span><br></pre></td></tr></table></figure><p>So to avoid external fragmentation and make sure that the hugepage allocation is always successful, we may want to reserve hugepages memory regions on boot time. This <a href="https://wiki.debian.org/Hugepages" target="_blank" rel="noopener">Debian Wiki Page</a> provides a way to do that. To reserve number of hugepages, add the following line in <code>/etc/sysctl.conf</code>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm.nr_hugepages = 1024</span><br></pre></td></tr></table></figure><p>And to mount it automatically on system start, simply add to <code>/etc/fstab</code>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hugetlbfs /hugepages hugetlbfs mode=1770,gid=2021 0 0</span><br></pre></td></tr></table></figure><h2 id="Advanced-Topics"><a href="#Advanced-Topics" class="headerlink" title="Advanced Topics"></a>Advanced Topics</h2><p>There are other advanced topics, which probably will not be covered in the scope of this quick note:</p><ul><li><strong>Transparent Huge Pages</strong>: system automatically decides if memory should be backed by hugepages, which make usage of hugepage memory much easier.</li><li><strong>libhugetlbfs APIs</strong>: <code>libhugetlbfs</code> provides programmer APIs to manage and access hugepage memory as well. Hugepage library utilities <code>hugectl</code> can overload Linux standard <code>shmget()</code> functions to allow huge pages to be used by allocating shared memory.</li><li><strong>Text And Data</strong>: <code>hugectl</code> has options to run an application, with its <code>text</code> and <code>data</code> section mapped by hugepages, which gives potential performance benefits.</li></ul><p>These are ideas worth digging into in the future, for applications where hugepages can potential give a good performance boost.</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://www.kernel.org/doc/Documentation/vm/hugetlbpage.txt" target="_blank" rel="noopener">Kernel Documentation of Hugetlbpage</a></li><li><a href="https://lwn.net/Articles/374424/" target="_blank" rel="noopener">LWN Intro to Huge Pages (1 Intro)</a></li><li><a href="https://lwn.net/Articles/375096/" target="_blank" rel="noopener">LWN Intro to Huge Pages (2 Interfaces)</a></li><li><a href="https://lwn.net/Articles/375096/" target="_blank" rel="noopener">LWN Intro to Huge Pages (3 Administration)</a></li><li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/performance_tuning_guide/s-memory-transhuge#s-memory-configure_hugepages" target="_blank" rel="noopener">Redhat Documentation on Performance Tuning: 5.2 Huge Pages And Transparent Huge Pages</a></li><li><a href="https://github.com/torvalds/linux/blob/master/tools/testing/selftests/vm/hugepage-mmap.c" target="_blank" rel="noopener">hugepage-mmap.c: Hugepage example in Linux source tree</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Page table is where Linux stores virtual to physical page address translation, and its size can get huge when memory usage is high. One way to reduce the size of page tables, and reduce the number of page faults, is to use huge pages. I’ve been digging some information on hugepages for my own curiosity, and it looks like Linux has pretty good support for huge pages. And this blog serves as a quick note on my readings.&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="https://blog.kevinhu.me/categories/Programming/"/>
    
    
      <category term="Linux" scheme="https://blog.kevinhu.me/tags/Linux/"/>
    
      <category term="Programming" scheme="https://blog.kevinhu.me/tags/Programming/"/>
    
      <category term="Hugepage" scheme="https://blog.kevinhu.me/tags/Hugepage/"/>
    
  </entry>
  
  <entry>
    <title>Reading-Summary 2018-05</title>
    <link href="https://blog.kevinhu.me/2018/05/21/2018-05-21-Reading-Summary/"/>
    <id>https://blog.kevinhu.me/2018/05/21/2018-05-21-Reading-Summary/</id>
    <published>2018-05-21T05:48:06.000Z</published>
    <updated>2018-05-21T06:43:59.364Z</updated>
    
    <content type="html"><![CDATA[<p>Posts I found interesting during my reading:</p><h3 id="Writing-a-Time-Series-Database-from-Scratch"><a href="#Writing-a-Time-Series-Database-from-Scratch" class="headerlink" title="Writing a Time Series Database from Scratch"></a><a href="https://fabxc.org/tsdb/" target="_blank" rel="noopener">Writing a Time Series Database from Scratch</a></h3><p>The author’s experience in writing a time-series database from groundup, for Prometheus.</p><h3 id="Introducing-Thanos-Prometheus-at-Scale"><a href="#Introducing-Thanos-Prometheus-at-Scale" class="headerlink" title="Introducing Thanos: Prometheus at Scale"></a><a href="https://improbable.io/games/blog/thanos-prometheus-at-scale" target="_blank" rel="noopener">Introducing Thanos: Prometheus at Scale</a></h3><p>The effort to scale Prometheus with a new project Thanos, with Kubernetes sidecar pattern, to read data from individual nodes, pre-process (e.g. sampling), and submit to acentralized data storage and display.</p><h3 id="A-Beginner’s-Guide-To-Scaling-To-11-Million-Users-On-Amazon’s-AWS"><a href="#A-Beginner’s-Guide-To-Scaling-To-11-Million-Users-On-Amazon’s-AWS" class="headerlink" title="A Beginner’s Guide To Scaling To 11 Million+ Users On Amazon’s AWS"></a><a href="http://highscalability.com/blog/2016/1/11/a-beginners-guide-to-scaling-to-11-million-users-on-amazons.html" target="_blank" rel="noopener">A Beginner’s Guide To Scaling To 11 Million+ Users On Amazon’s AWS</a></h3><p>What kind of machine/cluster you’ll need for different size of user base (from 1 to billions).</p><h3 id="Nexflix-FlameScope"><a href="#Nexflix-FlameScope" class="headerlink" title="Nexflix FlameScope"></a><a href="https://medium.com/netflix-techblog/netflix-flamescope-a57ca19d47bb" target="_blank" rel="noopener">Nexflix FlameScope</a></h3><p>A display of CPU trace as a Github-style texture tiles.</p><h3 id="A-Usable-C-Dialect-that-is-Safe-Against-Memory-Corruption"><a href="#A-Usable-C-Dialect-that-is-Safe-Against-Memory-Corruption" class="headerlink" title="A Usable C++ Dialect that is Safe Against Memory Corruption"></a><a href="http://ithare.com/a-usable-c-dialect-that-is-safe-against-memory-corruption/" target="_blank" rel="noopener">A Usable C++ Dialect that is Safe Against Memory Corruption</a></h3><p>IT-‘No Bug’-Hare is an interesting blog I found recently, focused on system, C++ language and game design. A good read for C++ fanatics and system designers.</p><hr><p>I’m feeling guilty for not updating for so long. But on the bright side: I’m back.</p><p>As a part of work requirements I’m taking on Golang and some small distributed system design jobs. It’s an interesting language for this task: network, systems, infrastructures, etc. I’m having mixed but mostly positive feelings about this language, and maybe will share my experience when I got a chance.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Posts I found interesting during my reading:&lt;/p&gt;
&lt;h3 id=&quot;Writing-a-Time-Series-Database-from-Scratch&quot;&gt;&lt;a href=&quot;#Writing-a-Time-Series-Dat
      
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
      <category term="Technology" scheme="https://blog.kevinhu.me/tags/Technology/"/>
    
  </entry>
  
  <entry>
    <title>Reading Summary 2017-06</title>
    <link href="https://blog.kevinhu.me/2017/06/11/Reading-Summary-2017-06/"/>
    <id>https://blog.kevinhu.me/2017/06/11/Reading-Summary-2017-06/</id>
    <published>2017-06-12T00:54:11.000Z</published>
    <updated>2018-03-25T21:29:55.938Z</updated>
    
    <content type="html"><![CDATA[<p>It’s been a while since I ever post a reading summary never mention a new blog post. Writing is a time demanding job.</p><h1 id="Society-and-Technology"><a href="#Society-and-Technology" class="headerlink" title="Society and Technology"></a>Society and Technology</h1><h3 id="Why-do-we-manage-academia-so-badly"><a href="#Why-do-we-manage-academia-so-badly" class="headerlink" title="Why do we manage academia so badly?"></a><a href="https://svpow.com/2017/03/22/why-do-we-manage-academia-so-badly/" target="_blank" rel="noopener">Why do we manage academia so badly?</a></h3><p><strong>“Managers want metrics that are easy to calculate, easy to understand, and quick to yield a value …metrics with these desirable properties are almost always worse than useless.”</strong></p><p>Easy metrics are also easily “hacked” - people “hack” the metrics to make statistics look good, while deviate from the original purpose of academia: to achieve good quality research.</p><p>See also:</p><p><a href="https://svpow.com/2017/03/17/every-attempt-to-manage-academia-makes-it-worse/" target="_blank" rel="noopener">Every attempt to manage academia makes it worse</a></p><h3 id="Did-Reddit’s-April-Fool’s-gag-solve-the-issue-of-online-hate-speech"><a href="#Did-Reddit’s-April-Fool’s-gag-solve-the-issue-of-online-hate-speech" class="headerlink" title="Did Reddit’s April Fool’s gag solve the issue of online hate speech?"></a><a href="https://arstechnica.com/gaming/2017/04/in-memoriam-reddits-72-hour-live-graffiti-wall-as-a-social-experiment/" target="_blank" rel="noopener">Did Reddit’s April Fool’s gag solve the issue of online hate speech?</a></h3><p>An interesting, anarchic style experiment on Reddit: let thousands of Redditers draw a picture all at the same time, what would possibly happen? It turned out to be surprisingly good.</p><h3 id="Tim-Berners-Lee-I-invented-the-web-Here-are-three-things-we-need-to-change-to-save-it"><a href="#Tim-Berners-Lee-I-invented-the-web-Here-are-three-things-we-need-to-change-to-save-it" class="headerlink" title="Tim Berners-Lee: I invented the web. Here are three things we need to change to save it"></a><a href="https://www.theguardian.com/technology/2017/mar/11/tim-berners-lee-web-inventor-save-internet" target="_blank" rel="noopener">Tim Berners-Lee: I invented the web. Here are three things we need to change to save it</a></h3><p>Tim Berners-Lee: The Father of the World Wide Web and Turing Award winner believes the web nowadays has serious flaws, namely the loss of control of personal privacy, rampant spreading of misinformation on the web, and manipulations from the political campaigns online. It took everyone to build the web we have today, and it takes everyone to fix it now.</p><p>More reports and readings on Tim Berners-Lee:</p><ul><li><a href="https://www.theguardian.com/technology/2009/mar/11/berners-lee-internet-data" target="_blank" rel="noopener">Web inventor warns against third-party internet snooping</a></li><li><a href="https://www.theguardian.com/technology/2017/apr/04/tim-berners-lee-online-privacy-interview-turing-award" target="_blank" rel="noopener">Tim Berners-Lee: selling private citizens’ browsing data is ‘disgusting’</a></li><li><a href="https://www.w3.org/DesignIssues/GovData.html" target="_blank" rel="noopener">Putting Government Data Online</a></li></ul><a id="more"></a><h3 id="Alan-Kay’s-Reading-List"><a href="#Alan-Kay’s-Reading-List" class="headerlink" title="Alan Kay’s Reading List"></a><a href="http://shelfjoy.com/shelfjoy/alan-kay-from-viewpoints-research-institute-recommends-his-reading-list-for-beginners" target="_blank" rel="noopener">Alan Kay’s Reading List</a></h3><p>Posted here again. He did so many tons of readings to get his insights on science, Computer Science, technology and society. It’s gonna be a long but joyful road.</p><h3 id="You’re-Not-Going-To-Believe-What-I’m-About-To-Tell-You"><a href="#You’re-Not-Going-To-Believe-What-I’m-About-To-Tell-You" class="headerlink" title="You’re Not Going To Believe What I’m About To Tell You"></a><a href="http://theoatmeal.com/comics/believe" target="_blank" rel="noopener">You’re Not Going To Believe What I’m About To Tell You</a></h3><p>Lesson 101 for a netizen: handling viewpoints that contradict your own. A good read.</p><h3 id="Crypto-Tokens-A-Breakthrough-in-Open-Network-Design"><a href="#Crypto-Tokens-A-Breakthrough-in-Open-Network-Design" class="headerlink" title="Crypto Tokens: A Breakthrough in Open Network Design"></a><a href="https://medium.com/@cdixon/crypto-tokens-a-breakthrough-in-open-network-design-e600975be2ef" target="_blank" rel="noopener">Crypto Tokens: A Breakthrough in Open Network Design</a></h3><p>How Ethereum and BlockChain technology may bring us a truly open, distributed Internet. Maybe.</p><h3 id="I-got-tired-of-commoditized-content-for-entrepreneurs-Here’s-what-I-started-watching-instead"><a href="#I-got-tired-of-commoditized-content-for-entrepreneurs-Here’s-what-I-started-watching-instead" class="headerlink" title="I got tired of commoditized content for entrepreneurs. Here’s what I started watching instead."></a><a href="https://blog.yalabot.com/i-got-sick-of-commoditized-content-for-entrepreneurs-heres-what-i-started-watching-instead-cdf9a5b28652" target="_blank" rel="noopener">I got tired of commoditized content for entrepreneurs. Here’s what I started watching instead.</a></h3><p>A curated list of video courses/podcasts for entrepreneurs.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;It’s been a while since I ever post a reading summary never mention a new blog post. Writing is a time demanding job.&lt;/p&gt;
&lt;h1 id=&quot;Society-and-Technology&quot;&gt;&lt;a href=&quot;#Society-and-Technology&quot; class=&quot;headerlink&quot; title=&quot;Society and Technology&quot;&gt;&lt;/a&gt;Society and Technology&lt;/h1&gt;&lt;h3 id=&quot;Why-do-we-manage-academia-so-badly&quot;&gt;&lt;a href=&quot;#Why-do-we-manage-academia-so-badly&quot; class=&quot;headerlink&quot; title=&quot;Why do we manage academia so badly?&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://svpow.com/2017/03/22/why-do-we-manage-academia-so-badly/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Why do we manage academia so badly?&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;“Managers want metrics that are easy to calculate, easy to understand, and quick to yield a value …
metrics with these desirable properties are almost always worse than useless.”&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Easy metrics are also easily “hacked” - people “hack” the metrics to make statistics look good, while deviate from the original purpose of academia: to achieve good quality research.&lt;/p&gt;
&lt;p&gt;See also:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://svpow.com/2017/03/17/every-attempt-to-manage-academia-makes-it-worse/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Every attempt to manage academia makes it worse&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Did-Reddit’s-April-Fool’s-gag-solve-the-issue-of-online-hate-speech&quot;&gt;&lt;a href=&quot;#Did-Reddit’s-April-Fool’s-gag-solve-the-issue-of-online-hate-speech&quot; class=&quot;headerlink&quot; title=&quot;Did Reddit’s April Fool’s gag solve the issue of online hate speech?&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://arstechnica.com/gaming/2017/04/in-memoriam-reddits-72-hour-live-graffiti-wall-as-a-social-experiment/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Did Reddit’s April Fool’s gag solve the issue of online hate speech?&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;An interesting, anarchic style experiment on Reddit: let thousands of Redditers draw a picture all at the same time, what would possibly happen? It turned out to be surprisingly good.&lt;/p&gt;
&lt;h3 id=&quot;Tim-Berners-Lee-I-invented-the-web-Here-are-three-things-we-need-to-change-to-save-it&quot;&gt;&lt;a href=&quot;#Tim-Berners-Lee-I-invented-the-web-Here-are-three-things-we-need-to-change-to-save-it&quot; class=&quot;headerlink&quot; title=&quot;Tim Berners-Lee: I invented the web. Here are three things we need to change to save it&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://www.theguardian.com/technology/2017/mar/11/tim-berners-lee-web-inventor-save-internet&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Tim Berners-Lee: I invented the web. Here are three things we need to change to save it&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Tim Berners-Lee: The Father of the World Wide Web and Turing Award winner believes the web nowadays has serious flaws, namely the loss of control of personal privacy, rampant spreading of misinformation on the web, and manipulations from the political campaigns online. It took everyone to build the web we have today, and it takes everyone to fix it now.&lt;/p&gt;
&lt;p&gt;More reports and readings on Tim Berners-Lee:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.theguardian.com/technology/2009/mar/11/berners-lee-internet-data&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Web inventor warns against third-party internet snooping&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.theguardian.com/technology/2017/apr/04/tim-berners-lee-online-privacy-interview-turing-award&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Tim Berners-Lee: selling private citizens’ browsing data is ‘disgusting’&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.w3.org/DesignIssues/GovData.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Putting Government Data Online&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
      <category term="Technology" scheme="https://blog.kevinhu.me/tags/Technology/"/>
    
  </entry>
  
  <entry>
    <title>Reading Summary 2017-03</title>
    <link href="https://blog.kevinhu.me/2017/03/26/Reading-Summary-2017-03/"/>
    <id>https://blog.kevinhu.me/2017/03/26/Reading-Summary-2017-03/</id>
    <published>2017-03-27T02:14:00.000Z</published>
    <updated>2018-03-25T21:29:55.714Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Programming"><a href="#Programming" class="headerlink" title="Programming"></a>Programming</h1><h3 id="Episode-51-Mechanics-of-Building-a-Carpooling-Service-Introduction"><a href="#Episode-51-Mechanics-of-Building-a-Carpooling-Service-Introduction" class="headerlink" title="Episode #51 - Mechanics of Building a Carpooling Service - Introduction"></a><a href="https://sysadmincasts.com/episodes/51-mechanics-of-building-a-carpooling-service-introduction" target="_blank" rel="noopener">Episode #51 - Mechanics of Building a Carpooling Service - Introduction</a></h3><p>Sysadmin Casts is back again, and this time with more stuff: how to turn an idea into a MVP.</p><h1 id="Technology"><a href="#Technology" class="headerlink" title="Technology"></a>Technology</h1><h3 id="Technology-Review-10-Breakthroughs-Technologies-2016"><a href="#Technology-Review-10-Breakthroughs-Technologies-2016" class="headerlink" title="Technology Review: 10 Breakthroughs Technologies 2016"></a><a href="https://www.technologyreview.com/lists/technologies/2016/" target="_blank" rel="noopener">Technology Review: 10 Breakthroughs Technologies 2016</a></h3><p>Artificial Intelligence for better conversational interfaces, Elon Musk’s companies, and biological technologies are back to people’s attention again.</p><a id="more"></a><h3 id="12½-Great-YouTube-Channels-For-Entrepreneurs"><a href="#12½-Great-YouTube-Channels-For-Entrepreneurs" class="headerlink" title="12½ Great YouTube Channels For Entrepreneurs"></a><a href="https://blog.yalabot.com/i-got-sick-of-commoditized-content-for-entrepreneurs-heres-what-i-started-watching-instead-cdf9a5b28652#.ovebbjiaj" target="_blank" rel="noopener">12½ Great YouTube Channels For Entrepreneurs</a></h3><p>YouTube channels for inspirations.</p><h3 id="Can-FPGA-Beat-GPUs-In-Accelerating-Next-Generation-Deep-Learning"><a href="#Can-FPGA-Beat-GPUs-In-Accelerating-Next-Generation-Deep-Learning" class="headerlink" title="Can FPGA Beat GPUs In Accelerating Next-Generation Deep Learning?"></a><a href="https://www.nextplatform.com/2017/03/21/can-fpgas-beat-gpus-accelerating-next-generation-deep-learning/" target="_blank" rel="noopener">Can FPGA Beat GPUs In Accelerating Next-Generation Deep Learning?</a></h3><p>Why FPGAs still have a shot.</p><h1 id="Social"><a href="#Social" class="headerlink" title="Social"></a>Social</h1><h3 id="What-if-Sociologists-Had-as-Much-Influence-as-Economists"><a href="#What-if-Sociologists-Had-as-Much-Influence-as-Economists" class="headerlink" title="What if Sociologists Had as Much Influence as Economists?"></a><a href="https://mobile.nytimes.com/2017/03/17/upshot/what-if-sociologists-had-as-much-influence-as-economists.html?smid=tw-nytimes&amp;smtyp=cur&amp;referer=https://t.co/DuJskMsbQf" target="_blank" rel="noopener">What if Sociologists Had as Much Influence as Economists?</a></h3><h3 id="Write-Good"><a href="#Write-Good" class="headerlink" title="Write Good"></a><a href="https://github.com/btford/write-good" target="_blank" rel="noopener">Write Good</a></h3><p>An interesting tool for better writing, including <a href="https://en.wikipedia.org/wiki/Flesch%E2%80%93Kincaid_readability_tests" target="_blank" rel="noopener">Flesch–Kincaid readability tests</a> and pointing out <a href="https://en.wikipedia.org/wiki/Weasel_word" target="_blank" rel="noopener">Weasel Words</a>.</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Programming&quot;&gt;&lt;a href=&quot;#Programming&quot; class=&quot;headerlink&quot; title=&quot;Programming&quot;&gt;&lt;/a&gt;Programming&lt;/h1&gt;&lt;h3 id=&quot;Episode-51-Mechanics-of-Building-a-Carpooling-Service-Introduction&quot;&gt;&lt;a href=&quot;#Episode-51-Mechanics-of-Building-a-Carpooling-Service-Introduction&quot; class=&quot;headerlink&quot; title=&quot;Episode #51 - Mechanics of Building a Carpooling Service - Introduction&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://sysadmincasts.com/episodes/51-mechanics-of-building-a-carpooling-service-introduction&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Episode #51 - Mechanics of Building a Carpooling Service - Introduction&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Sysadmin Casts is back again, and this time with more stuff: how to turn an idea into a MVP.&lt;/p&gt;
&lt;h1 id=&quot;Technology&quot;&gt;&lt;a href=&quot;#Technology&quot; class=&quot;headerlink&quot; title=&quot;Technology&quot;&gt;&lt;/a&gt;Technology&lt;/h1&gt;&lt;h3 id=&quot;Technology-Review-10-Breakthroughs-Technologies-2016&quot;&gt;&lt;a href=&quot;#Technology-Review-10-Breakthroughs-Technologies-2016&quot; class=&quot;headerlink&quot; title=&quot;Technology Review: 10 Breakthroughs Technologies 2016&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://www.technologyreview.com/lists/technologies/2016/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Technology Review: 10 Breakthroughs Technologies 2016&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Artificial Intelligence for better conversational interfaces, Elon Musk’s companies, and biological technologies are back to people’s attention again.&lt;/p&gt;
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
      <category term="Python" scheme="https://blog.kevinhu.me/tags/Python/"/>
    
      <category term="C/C++" scheme="https://blog.kevinhu.me/tags/C-C/"/>
    
  </entry>
  
  <entry>
    <title>Reading Summary 2016-12</title>
    <link href="https://blog.kevinhu.me/2017/01/08/Reading-Summary-2016-12/"/>
    <id>https://blog.kevinhu.me/2017/01/08/Reading-Summary-2016-12/</id>
    <published>2017-01-09T05:15:00.000Z</published>
    <updated>2018-03-25T21:29:55.734Z</updated>
    
    <content type="html"><![CDATA[<h1 id="C-C"><a href="#C-C" class="headerlink" title="C/C++"></a>C/C++</h1><h3 id="How-to-find-size-of-an-array-in-C-without-sizeof"><a href="#How-to-find-size-of-an-array-in-C-without-sizeof" class="headerlink" title="How to find size of an array in C without sizeof"></a><a href="http://arjunsreedharan.org/post/69303442896/the-difference-between-arr-and-arr-how-to-find" target="_blank" rel="noopener">How to find size of an array in C without sizeof</a></h3><p>The difference between arr and &amp;arr - basically, arr is of type int <em>, and &amp;arr is of type (int </em>)[size].</p><p>Very excellent article on the fundamentals of C/C++!</p><h3 id="What-Every-C-Programmer-Should-Know-About-Undefined-Behavior"><a href="#What-Every-C-Programmer-Should-Know-About-Undefined-Behavior" class="headerlink" title="What Every C Programmer Should Know About Undefined Behavior"></a><a href="http://blog.llvm.org/2011/05/what-every-c-programmer-should-know_14.html" target="_blank" rel="noopener">What Every C Programmer Should Know About Undefined Behavior</a></h3><p>Some “gotchas” and pitfalls in the C programming language and how sometimes compiler optimizations can make it worse. Long story short is, steer away from undefined behaviors.</p><p>This post is from Chris Lattner himeself. Really nice article.</p><h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><h3 id="Python-Has-Big-Impact-At-Red-Hat"><a href="#Python-Has-Big-Impact-At-Red-Hat" class="headerlink" title="Python Has Big Impact At Red Hat"></a><a href="http://community.redhat.com/blog/2016/12/python-has-big-impact-at-red-hat/" target="_blank" rel="noopener">Python Has Big Impact At Red Hat</a></h3><p>Why Python is such a cool language and how Python is used in Redhat. Most of redhat’s important infrastructure is written in Python, including but not limited to <code>firewalld</code>, <code>yum</code>, and its successor <code>dnf</code>, and many cloud PaaS tools for OpenShift.</p><a id="more"></a><h3 id="Statistics-For-Hackers-PyCon2016-Video"><a href="#Statistics-For-Hackers-PyCon2016-Video" class="headerlink" title="Statistics For Hackers - PyCon2016 (Video)"></a><a href="https://youtu.be/Iq9DzN6mvYA" target="_blank" rel="noopener">Statistics For Hackers - PyCon2016 (Video)</a></h3><p>How to write a few lines of Python to simulate for a statistic problem which otherwise be onerous with all the math theorems and formulas.</p><h3 id="Refactoring-Python-Why-and-how-to-restructure-your-code-PyCon2016-Video"><a href="#Refactoring-Python-Why-and-how-to-restructure-your-code-PyCon2016-Video" class="headerlink" title="Refactoring Python: Why and how to restructure your code - PyCon2016 (Video)"></a><a href="https://youtu.be/D_6ybDcU5gc" target="_blank" rel="noopener">Refactoring Python: Why and how to restructure your code - PyCon2016 (Video)</a></h3><p>How to write clean, well-structured and “Pythonic” code.</p><h3 id="Python-Language-PyCon2016-Video"><a href="#Python-Language-PyCon2016-Video" class="headerlink" title="Python Language - PyCon2016 (Video)"></a><a href="https://youtu.be/YgtL4S7Hrwo" target="_blank" rel="noopener">Python Language - PyCon2016 (Video)</a></h3><p>By no one but Guido van Rossum himself, on the status of Python 3, and how he created Python.</p><p>(And Death to Python 2!!)</p><h3 id="Stop-Writing-Classes-PyCon2012-Video"><a href="#Stop-Writing-Classes-PyCon2012-Video" class="headerlink" title="Stop Writing Classes - PyCon2012 (Video)"></a><a href="https://youtu.be/o9pEzgHorH0" target="_blank" rel="noopener">Stop Writing Classes - PyCon2012 (Video)</a></h3><p>Stop writing classes - when, and when not to use classes. Stop thinking in Java (no offense), and learn to be “Pythonic”, for a smaller, cleaner, and more well-structured project code base.</p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc."></a>Misc.</h1><h3 id="If-You’re-So-Smart-Why-Aren’t-You-Rich"><a href="#If-You’re-So-Smart-Why-Aren’t-You-Rich" class="headerlink" title="If You’re So Smart, Why Aren’t You Rich?"></a><a href="https://www.bloomberg.com/view/articles/2016-12-22/if-you-re-so-smart-why-aren-t-you-rich" target="_blank" rel="noopener">If You’re So Smart, Why Aren’t You Rich?</a></h3><p>Conscientiousness - “A Personality trait marked by diligence, perseverance and self-discipline”.</p><h3 id="Thinking-about-thinking"><a href="#Thinking-about-thinking" class="headerlink" title="Thinking about thinking"></a><a href="http://www.economist.com/news/books-and-arts/21711860-michael-lewis-dissects-enduring-friendship-between-daniel-kahneman-and-amos?fsrc=scn%2Ftw%2Fte%2Fbl%2Fed%2Fthinkingaboutthinking" target="_blank" rel="noopener">Thinking about thinking</a></h3><p>Daniel Kahneman - I’ve been recently reading his book <a href="https://www.amazon.com/Thinking-Fast-Slow-Daniel-Kahneman/dp/0374533555/" target="_blank" rel="noopener">“Thinking: Fast and Slow”</a>. It’s often listed as work in economics, but from what I’ve read it’s also an amazing book on psychology and human cognitives.</p><p>Reading more books is definitely one of my New Year resolutions. Just started this book, will finish.</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;C-C&quot;&gt;&lt;a href=&quot;#C-C&quot; class=&quot;headerlink&quot; title=&quot;C/C++&quot;&gt;&lt;/a&gt;C/C++&lt;/h1&gt;&lt;h3 id=&quot;How-to-find-size-of-an-array-in-C-without-sizeof&quot;&gt;&lt;a href=&quot;#How-to-find-size-of-an-array-in-C-without-sizeof&quot; class=&quot;headerlink&quot; title=&quot;How to find size of an array in C without sizeof&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://arjunsreedharan.org/post/69303442896/the-difference-between-arr-and-arr-how-to-find&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;How to find size of an array in C without sizeof&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The difference between arr and &amp;amp;arr - basically, arr is of type int &lt;em&gt;, and &amp;amp;arr is of type (int &lt;/em&gt;)[size].&lt;/p&gt;
&lt;p&gt;Very excellent article on the fundamentals of C/C++!&lt;/p&gt;
&lt;h3 id=&quot;What-Every-C-Programmer-Should-Know-About-Undefined-Behavior&quot;&gt;&lt;a href=&quot;#What-Every-C-Programmer-Should-Know-About-Undefined-Behavior&quot; class=&quot;headerlink&quot; title=&quot;What Every C Programmer Should Know About Undefined Behavior&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://blog.llvm.org/2011/05/what-every-c-programmer-should-know_14.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;What Every C Programmer Should Know About Undefined Behavior&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Some “gotchas” and pitfalls in the C programming language and how sometimes compiler optimizations can make it worse. Long story short is, steer away from undefined behaviors.&lt;/p&gt;
&lt;p&gt;This post is from Chris Lattner himeself. Really nice article.&lt;/p&gt;
&lt;h1 id=&quot;Python&quot;&gt;&lt;a href=&quot;#Python&quot; class=&quot;headerlink&quot; title=&quot;Python&quot;&gt;&lt;/a&gt;Python&lt;/h1&gt;&lt;h3 id=&quot;Python-Has-Big-Impact-At-Red-Hat&quot;&gt;&lt;a href=&quot;#Python-Has-Big-Impact-At-Red-Hat&quot; class=&quot;headerlink&quot; title=&quot;Python Has Big Impact At Red Hat&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://community.redhat.com/blog/2016/12/python-has-big-impact-at-red-hat/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Python Has Big Impact At Red Hat&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Why Python is such a cool language and how Python is used in Redhat. Most of redhat’s important infrastructure is written in Python, including but not limited to &lt;code&gt;firewalld&lt;/code&gt;, &lt;code&gt;yum&lt;/code&gt;, and its successor &lt;code&gt;dnf&lt;/code&gt;, and many cloud PaaS tools for OpenShift.&lt;/p&gt;
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
      <category term="Python" scheme="https://blog.kevinhu.me/tags/Python/"/>
    
      <category term="Compilers" scheme="https://blog.kevinhu.me/tags/Compilers/"/>
    
      <category term="Undefined Behavior" scheme="https://blog.kevinhu.me/tags/Undefined-Behavior/"/>
    
      <category term="C/C++" scheme="https://blog.kevinhu.me/tags/C-C/"/>
    
  </entry>
  
  <entry>
    <title>Reading Summary 2016-11</title>
    <link href="https://blog.kevinhu.me/2016/11/27/Reading-Summary-2016-11/"/>
    <id>https://blog.kevinhu.me/2016/11/27/Reading-Summary-2016-11/</id>
    <published>2016-11-28T05:56:03.000Z</published>
    <updated>2018-03-25T21:29:55.643Z</updated>
    
    <content type="html"><![CDATA[<h1 id="C-C"><a href="#C-C" class="headerlink" title="C/C++"></a>C/C++</h1><h3 id="“Effective-C-”-and-“C-In-A-Nutshell”"><a href="#“Effective-C-”-and-“C-In-A-Nutshell”" class="headerlink" title="“Effective C++” and “C++ In A Nutshell”"></a>“Effective C++” and “C++ In A Nutshell”</h3><p>Finished most part of “C++ In A Nutshell”, and Scott Meyer’s “Effective C++”, and started to learn the basics of C++ language. Really great books to start to learn the basics of C++, and some of the fundamental problems in the language.</p><a id="more"></a><h1 id="System-Design"><a href="#System-Design" class="headerlink" title="System Design"></a>System Design</h1><h3 id="What-Are-System-Design-Questions"><a href="#What-Are-System-Design-Questions" class="headerlink" title="What Are System Design Questions?"></a><a href="https://www.hiredintech.com/classrooms/system-design/lesson/52" target="_blank" rel="noopener">What Are System Design Questions?</a></h3><p>A very interesting guide to scalable system design and how you should deal with them in an interview. It’s very interesting to learn the basics, while to do them properly, it might require years of experience.</p><h3 id="Scalability-For-Dummies"><a href="#Scalability-For-Dummies" class="headerlink" title="Scalability For Dummies"></a><a href="http://www.lecloud.net/post/7295452622/scalability-for-dummies-part-1-clones" target="_blank" rel="noopener">Scalability For Dummies</a></h3><p>A guide to scalability, a series of interesting and concise introduction to the same problem.</p><h1 id="Unix"><a href="#Unix" class="headerlink" title="Unix"></a>Unix</h1><h3 id="Unix-As-IDE-Introduction"><a href="#Unix-As-IDE-Introduction" class="headerlink" title="Unix As IDE: Introduction"></a><a href="https://sanctum.geek.nz/arabesque/series/unix-as-ide/" target="_blank" rel="noopener">Unix As IDE: Introduction</a></h3><p>A very interesting guide on how to use Unix’s core utilities (grep, find, bash, awk, sort, gcc, gdb, git, vim/emacs, …) to arm yourself for code editing/maintenance tasks.</p><h1 id="Programming-Languages"><a href="#Programming-Languages" class="headerlink" title="Programming Languages"></a>Programming Languages</h1><h3 id="How-It-Feels-To-Learn-JavaScript-In-2016"><a href="#How-It-Feels-To-Learn-JavaScript-In-2016" class="headerlink" title="How It Feels To Learn JavaScript In 2016"></a><a href="https://hackernoon.com/how-it-feels-to-learn-javascript-in-2016-d3a717dd577f#.7pr0vhyyb" target="_blank" rel="noopener">How It Feels To Learn JavaScript In 2016</a></h3><p>JavaScript…</p><h3 id="The-Definitive-Guide-to-Python-Exceptions"><a href="#The-Definitive-Guide-to-Python-Exceptions" class="headerlink" title="The Definitive Guide to Python Exceptions"></a><a href="https://julien.danjou.info/blog/2016/python-exceptions-guide" target="_blank" rel="noopener">The Definitive Guide to Python Exceptions</a></h3><p>A Python hacker’s guide to Python, from the author of “The Hacker’s Guide To Python”.</p><h1 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h1><h3 id="Why-Democracy-Rewards-Bad-People"><a href="#Why-Democracy-Rewards-Bad-People" class="headerlink" title="Why Democracy Rewards Bad People"></a><a href="https://mises.org/blog/why-democracy-rewards-bad-people" target="_blank" rel="noopener">Why Democracy Rewards Bad People</a></h3><p>In light of the recent election…</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;C-C&quot;&gt;&lt;a href=&quot;#C-C&quot; class=&quot;headerlink&quot; title=&quot;C/C++&quot;&gt;&lt;/a&gt;C/C++&lt;/h1&gt;&lt;h3 id=&quot;“Effective-C-”-and-“C-In-A-Nutshell”&quot;&gt;&lt;a href=&quot;#“Effective-C-”-and-“C-In-A-Nutshell”&quot; class=&quot;headerlink&quot; title=&quot;“Effective C++” and “C++ In A Nutshell”&quot;&gt;&lt;/a&gt;“Effective C++” and “C++ In A Nutshell”&lt;/h3&gt;&lt;p&gt;Finished most part of “C++ In A Nutshell”, and Scott Meyer’s “Effective C++”, and started to learn the basics of C++ language. Really great books to start to learn the basics of C++, and some of the fundamental problems in the language.&lt;/p&gt;
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
  </entry>
  
  <entry>
    <title>Reading Summary 2016-09</title>
    <link href="https://blog.kevinhu.me/2016/09/28/Reading-Summary-2016-09/"/>
    <id>https://blog.kevinhu.me/2016/09/28/Reading-Summary-2016-09/</id>
    <published>2016-09-28T05:11:03.000Z</published>
    <updated>2018-03-25T21:29:55.744Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reading"><a href="#Reading" class="headerlink" title="Reading"></a>Reading</h1><h3 id="A-Bit-of-Python"><a href="#A-Bit-of-Python" class="headerlink" title="A Bit of Python"></a><a href="https://access.redhat.com/blogs/766093/posts/2592591" target="_blank" rel="noopener">A Bit of Python</a></h3><p>Some security pitfalls in Python language. Very interesting read, from RedHat.</p><h3 id="Improving-Workflow-By-Using-Clang-based-Tools"><a href="#Improving-Workflow-By-Using-Clang-based-Tools" class="headerlink" title="Improving Workflow By Using Clang-based Tools"></a><a href="https://omtcyfz.github.io/2016/08/30/Improving-workflow-by-using-Clang-based-tools.html" target="_blank" rel="noopener">Improving Workflow By Using Clang-based Tools</a></h3><h3 id="Tips-For-Productive-Debugging-With-GDB"><a href="#Tips-For-Productive-Debugging-With-GDB" class="headerlink" title="Tips For Productive Debugging With GDB"></a><a href="https://metricpanda.com/tips-for-productive-debugging-with-gdb" target="_blank" rel="noopener">Tips For Productive Debugging With GDB</a></h3><p>A very beautifully crafted GDB init file. Worth taking a look.</p><h3 id="The-Definitive-Guide-to-Python-Exceptions"><a href="#The-Definitive-Guide-to-Python-Exceptions" class="headerlink" title="The Definitive Guide to Python Exceptions"></a><a href="https://julien.danjou.info/blog/2016/python-exceptions-guide" target="_blank" rel="noopener">The Definitive Guide to Python Exceptions</a></h3><p>From the author of ‘The Hacker’s Guide to Python’.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reading&quot;&gt;&lt;a href=&quot;#Reading&quot; class=&quot;headerlink&quot; title=&quot;Reading&quot;&gt;&lt;/a&gt;Reading&lt;/h1&gt;&lt;h3 id=&quot;A-Bit-of-Python&quot;&gt;&lt;a href=&quot;#A-Bit-of-Python&quot; c
      
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
  </entry>
  
  <entry>
    <title>Reading Summary 2016-08</title>
    <link href="https://blog.kevinhu.me/2016/08/15/Reading-Summary-2016-08/"/>
    <id>https://blog.kevinhu.me/2016/08/15/Reading-Summary-2016-08/</id>
    <published>2016-08-16T04:51:14.000Z</published>
    <updated>2018-03-25T21:29:55.912Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reading"><a href="#Reading" class="headerlink" title="Reading"></a>Reading</h1><h3 id="Alan-Kay’s-Reading-List"><a href="#Alan-Kay’s-Reading-List" class="headerlink" title="Alan Kay’s Reading List"></a><a href="http://www.squeakland.org/resources/books/readingList.jsp" target="_blank" rel="noopener">Alan Kay’s Reading List</a></h3><p>If this site is reliable, this is Alan Kay’s reading list for all his students. He’s a great thinker, not just in Computer Science, but human intelligence in general. His list is a constant reminder how much I’m trailing the great minds of this generation, and how much I should pick up the pace in reading.</p><h2 id="How-to-use-your-full-brain-when-writing-code"><a href="#How-to-use-your-full-brain-when-writing-code" class="headerlink" title="How to use your full brain when writing code"></a><a href="http://chrismm.com/blog/how-to-use-your-full-brain-when-writing-code/" target="_blank" rel="noopener">How to use your full brain when writing code</a></h2><p>Tips on being an efficient programmer.</p><h1 id="Digital-Rights"><a href="#Digital-Rights" class="headerlink" title="Digital Rights"></a>Digital Rights</h1><h3 id="How-Technology-Hijacks-People’s-Minds-from-a-Magician-and-Google’s-Design-Ethicist"><a href="#How-Technology-Hijacks-People’s-Minds-from-a-Magician-and-Google’s-Design-Ethicist" class="headerlink" title="How Technology Hijacks People’s Minds -from a Magician and Google’s Design Ethicist"></a><a href="https://medium.com/swlh/how-technology-hijacks-peoples-minds-from-a-magician-and-google-s-design-ethicist-56d62ef5edf3#.c9i8kx8cg" target="_blank" rel="noopener">How Technology Hijacks People’s Minds -from a Magician and Google’s Design Ethicist</a></h3><p>Interestingly how big companies like Facebook and Google use techniques to enchant you to stay on their page for more time, or click on more of their links. I think it’s an interesting read that raises our awareness against cases such tricks, and help us defend ourselves from such exploitation.</p><h3 id="Reweaving-the-web"><a href="#Reweaving-the-web" class="headerlink" title="Reweaving the web"></a><a href="http://www.economist.com/news/business/21700642-slew-startups-trying-decentralise-online-world-reweaving-web?fsrc=scn/tw/te/pe/ed/reweavingtheweb" target="_blank" rel="noopener">Reweaving the web</a></h3><p>How a slew of new startup decide to use the latest technology such as “Blockchain” and “Ethereum” to decentralize the key web infrastructures and the World Wide Web they support, to compete against giant cooperations like Google and Facebook. It’s an interesting to trend to keep an eye on, but so far I don’t know if I have the optimism that they’ll succeed.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Reading&quot;&gt;&lt;a href=&quot;#Reading&quot; class=&quot;headerlink&quot; title=&quot;Reading&quot;&gt;&lt;/a&gt;Reading&lt;/h1&gt;&lt;h3 id=&quot;Alan-Kay’s-Reading-List&quot;&gt;&lt;a href=&quot;#Alan-Kay’s
      
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
  </entry>
  
  <entry>
    <title>Reading Summary 2016-04</title>
    <link href="https://blog.kevinhu.me/2016/05/06/Reading-Summary-2016-04/"/>
    <id>https://blog.kevinhu.me/2016/05/06/Reading-Summary-2016-04/</id>
    <published>2016-05-06T06:34:31.000Z</published>
    <updated>2018-03-25T21:29:55.619Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Programming"><a href="#Programming" class="headerlink" title="Programming"></a>Programming</h1><h3 id="Eli-Bendersky’s-Website"><a href="#Eli-Bendersky’s-Website" class="headerlink" title="Eli Bendersky’s Website"></a><a href="http://eli.thegreenplace.net/" target="_blank" rel="noopener">Eli Bendersky’s Website</a></h3><p>Eli Bendersky’s blog has always been a must-read to me. He never fails to regularly come up with posts of interesting and insightful ideas, or detailed tutorials.</p><p>He also actively participates in LLVM-dev mailing list and based on his blogs, has board interests in programming language, computer systems and etc..</p><h1 id="Computer-Science"><a href="#Computer-Science" class="headerlink" title="Computer Science"></a>Computer Science</h1><h3 id="What-is-HCI-research-And-what-is-its-relationship-to-computer-science"><a href="#What-is-HCI-research-And-what-is-its-relationship-to-computer-science" class="headerlink" title="What is HCI research? And what is its relationship to computer science?"></a><a href="http://www.pgbovine.net/what-is-hci-research.htm" target="_blank" rel="noopener">What is HCI research? And what is its relationship to computer science?</a></h3><p>Phillip Guo is another one of my favorite bloggers. This time he wrote an intro to HCI research.</p><a id="more"></a><hr><p>I haven’t read extensively from books or blogs recently, which is a shame. I shall definitely invest more time in reading and expanding knowledge.</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Programming&quot;&gt;&lt;a href=&quot;#Programming&quot; class=&quot;headerlink&quot; title=&quot;Programming&quot;&gt;&lt;/a&gt;Programming&lt;/h1&gt;&lt;h3 id=&quot;Eli-Bendersky’s-Website&quot;&gt;&lt;a href=&quot;#Eli-Bendersky’s-Website&quot; class=&quot;headerlink&quot; title=&quot;Eli Bendersky’s Website&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://eli.thegreenplace.net/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Eli Bendersky’s Website&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Eli Bendersky’s blog has always been a must-read to me. He never fails to regularly come up with posts of interesting and insightful ideas, or detailed tutorials.&lt;/p&gt;
&lt;p&gt;He also actively participates in LLVM-dev mailing list and based on his blogs, has board interests in programming language, computer systems and etc..&lt;/p&gt;
&lt;h1 id=&quot;Computer-Science&quot;&gt;&lt;a href=&quot;#Computer-Science&quot; class=&quot;headerlink&quot; title=&quot;Computer Science&quot;&gt;&lt;/a&gt;Computer Science&lt;/h1&gt;&lt;h3 id=&quot;What-is-HCI-research-And-what-is-its-relationship-to-computer-science&quot;&gt;&lt;a href=&quot;#What-is-HCI-research-And-what-is-its-relationship-to-computer-science&quot; class=&quot;headerlink&quot; title=&quot;What is HCI research? And what is its relationship to computer science?&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.pgbovine.net/what-is-hci-research.htm&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;What is HCI research? And what is its relationship to computer science?&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Phillip Guo is another one of my favorite bloggers. This time he wrote an intro to HCI research.&lt;/p&gt;
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
  </entry>
  
  <entry>
    <title>Avoid Nasal Demons</title>
    <link href="https://blog.kevinhu.me/2016/02/21/Avoid-Nasal-Damons/"/>
    <id>https://blog.kevinhu.me/2016/02/21/Avoid-Nasal-Damons/</id>
    <published>2016-02-21T07:31:27.000Z</published>
    <updated>2018-03-25T21:29:55.779Z</updated>
    
    <content type="html"><![CDATA[<p>Recently my colleague and I were working to port V8 JS engine as one of our benchmarks. We used it as it’s a widely-used library on devices we cared about, and we believed it’s a well-maintained, high code quality project. Or at least we thought.</p><a id="more"></a><p>The very recent GCC 6.0 version in trunk, however, will produce bad binary for a relatively stable version of V8 with <code>-O3</code> flag enabled. The output binary will segfault on some of the very basic tests. At first we immediately assumed it was a bug from the bleeding-edge GCC, and submitted the bug report to the community, which responded promptly (within half an hour, that’s incredible speed. Kudos for GCC), that the problem resulted from an undefined behavior in V8. The problem roots in the fact that some V8 code is dereference null object pointers to access member functions. You can even see in their C++ code comparing <code>this</code> to <code>NULL</code> in class member functions.</p><pre><code>if (this == NULL) {   // some logic}</code></pre><p>And new GCC decided to optimize it away. Cause in well-defined C++ programs, <code>this</code> will never be <code>NULL</code>.</p><p>Undefined behavior are also referred to as <a href="">Nasal Demons</a>. The “dereferencing NULL pointer” code has also been discussed in this well-written post: <a href="http://www.viva64.com/en/b/0226/" target="_blank" rel="noopener">Still Comparing “this” Pointer to Null?</a>, about the hazards of using it. Somehow, from M$ MFC library, to widely used V8 JS engine, they are all using this for a happy hacking experience. This tech debt is a time bomb they plant in their code, and no one knows when it will go off. For V8 it was around Oct. 2015 when mainline trunk GCC guys decided to use this undefined behavior for optimization, which causes crashes in produced V8 binary.</p><p>Theoretically it could be worse: this can cause a security vulnerability. And the problematic code will work just fine with the last revision of GCC compiler, but not with the very next commit. It’s a nightmare for anyone to debug.</p><p>Guys in chromium project seem to be aware of this problem for some time. I quote: “Fundamentally this is fixable by making the functions static and explicitly passing the entity as parameter, but that’s a  tremendous amount of work.” See this bug:</p><p><a href="https://bugs.chromium.org/p/v8/issues/detail?id=3782" target="_blank" rel="noopener">https://bugs.chromium.org/p/v8/issues/detail?id=3782</a></p><p>All coders who touched V8 code should be much smarter than I am. But somehow they just let this code slip in, and right now the bad code piles up and it’s too hard to fix. The moral of this story is: C/C++ is a very hard language to use right, and it should take much patience to learn, understand, and write correct, clean code. Without patience to learn correct code, fall to the dark side of the source one easily will.</p><p><img src="yoda-patience.jpeg" alt="Patience, you must have"></p><p>Looks like this code has bitten other people as well. And they are from quite a while ago:</p><p><a href="https://jira.mongodb.org/browse/SERVER-15182" target="_blank" rel="noopener">https://jira.mongodb.org/browse/SERVER-15182</a></p><p><a href="https://jira.mongodb.org/browse/SERVER-15306" target="_blank" rel="noopener">https://jira.mongodb.org/browse/SERVER-15306</a></p><p>Attached is a pretty good presentation on undefined C/C++ code:</p><p><a href="http://www.slideshare.net/linaroorg/bkk16503-undefined-behavior-and-compiler-optimizations-why-your-program-stopped-working-with-a-newer-compiler" target="_blank" rel="noopener">http://www.slideshare.net/linaroorg/bkk16503-undefined-behavior-and-compiler-optimizations-why-your-program-stopped-working-with-a-newer-compiler</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Recently my colleague and I were working to port V8 JS engine as one of our benchmarks. We used it as it’s a widely-used library on devices we cared about, and we believed it’s a well-maintained, high code quality project. Or at least we thought.&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="https://blog.kevinhu.me/categories/Programming/"/>
    
    
      <category term="Undefined Behavior" scheme="https://blog.kevinhu.me/tags/Undefined-Behavior/"/>
    
  </entry>
  
  <entry>
    <title>Reading Summary 2016-02</title>
    <link href="https://blog.kevinhu.me/2016/02/20/Reading-Summary-2016-01/"/>
    <id>https://blog.kevinhu.me/2016/02/20/Reading-Summary-2016-01/</id>
    <published>2016-02-21T02:08:07.000Z</published>
    <updated>2018-03-25T21:29:55.609Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Programming"><a href="#Programming" class="headerlink" title="Programming"></a>Programming</h1><h3 id="A-critique-of-“How-to-C-in-2016”-by-Matt"><a href="#A-critique-of-“How-to-C-in-2016”-by-Matt" class="headerlink" title="A critique of “How to C in 2016” by Matt"></a><a href="https://github.com/Keith-S-Thompson/how-to-c-response/blob/master/README.md" target="_blank" rel="noopener">A critique of “How to C in 2016” by Matt</a></h3><p>A good review as well as critique to the original <a href="https://matt.sh/howto-c" target="_blank" rel="noopener">“How to C in 2016”</a>, debunking some myths, and making suggestions on how to really code in C.</p><h1 id="Miscellany"><a href="#Miscellany" class="headerlink" title="Miscellany"></a>Miscellany</h1><h3 id="List-of-Common-Misconceptions-from-Wikipedia"><a href="#List-of-Common-Misconceptions-from-Wikipedia" class="headerlink" title="List of Common Misconceptions from Wikipedia."></a><a href="https://en.m.wikipedia.org/wiki/List_of_common_misconceptions" target="_blank" rel="noopener">List of Common Misconceptions</a> from Wikipedia.</h3><h3 id="Best-of-2015-The-Social-Network-Illusion-That-Tricks-Your-Mind"><a href="#Best-of-2015-The-Social-Network-Illusion-That-Tricks-Your-Mind" class="headerlink" title="Best of 2015: The Social-Network Illusion That Tricks Your Mind"></a><a href="https://www.technologyreview.com/s/544786/best-of-2015-the-social-network-illusion-that-tricks-your-mind/" target="_blank" rel="noopener">Best of 2015: The Social-Network Illusion That Tricks Your Mind</a></h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Programming&quot;&gt;&lt;a href=&quot;#Programming&quot; class=&quot;headerlink&quot; title=&quot;Programming&quot;&gt;&lt;/a&gt;Programming&lt;/h1&gt;&lt;h3 id=&quot;A-critique-of-“How-to-C-in-20
      
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
      <category term="Social" scheme="https://blog.kevinhu.me/tags/Social/"/>
    
      <category term="Coding" scheme="https://blog.kevinhu.me/tags/Coding/"/>
    
  </entry>
  
  <entry>
    <title>Reading Summary 2015-12</title>
    <link href="https://blog.kevinhu.me/2015/12/31/Reading-Summary-2015-12/"/>
    <id>https://blog.kevinhu.me/2015/12/31/Reading-Summary-2015-12/</id>
    <published>2015-12-31T07:30:43.000Z</published>
    <updated>2018-03-25T21:29:55.633Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Frontend"><a href="#Frontend" class="headerlink" title="Frontend"></a>Frontend</h1><h3 id="How-to-set-up-a-Web-development-environment-with-React-Babel-Webpack-and-JavaScript-ES6-Philip-Guo"><a href="#How-to-set-up-a-Web-development-environment-with-React-Babel-Webpack-and-JavaScript-ES6-Philip-Guo" class="headerlink" title="How to set up a Web development environment with React, Babel, Webpack, and JavaScript ES6 - Philip Guo"></a><a href="http://www.pgbovine.net/react-babel-webpack-javascript-es6-setup.htm" target="_blank" rel="noopener">How to set up a Web development environment with React, Babel, Webpack, and JavaScript ES6 - Philip Guo</a></h3><h3 id="Minimal-fuss-setup-for-getting-started-with-React-and-JavaScript-ES6"><a href="#Minimal-fuss-setup-for-getting-started-with-React-and-JavaScript-ES6" class="headerlink" title="Minimal fuss setup for getting started with React and JavaScript ES6"></a><a href="http://www.pgbovine.net/react-es6-js-setup-minimal.htm" target="_blank" rel="noopener">Minimal fuss setup for getting started with React and JavaScript ES6</a></h3><p>The minimal fuss setup for frontend development, from Philip, one of my favorite professor, programmer and bloggers. </p><a id="more"></a><h1 id="Compiler"><a href="#Compiler" class="headerlink" title="Compiler"></a>Compiler</h1><h3 id="Reverse-Engineering-for-Beginners"><a href="#Reverse-Engineering-for-Beginners" class="headerlink" title="Reverse Engineering for Beginners"></a><a href="http://beginners.re/" target="_blank" rel="noopener">Reverse Engineering for Beginners</a></h3><p>Or rather, an intro to assembly. I’ve just took a quick glimpse on the lite version, which is x86/x86_64 MSVC assembly only. A quick review to polish the memories on x86 assembly.</p><p>The full version also contains ARM version of assembly, which is my next target.</p><h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><h3 id="PEP8"><a href="#PEP8" class="headerlink" title="PEP8"></a><a href="https://www.python.org/dev/peps/pep-0008/" target="_blank" rel="noopener">PEP8</a></h3><p>The PEP8 Style Guide for Python Code. A good guide to writing consistently readable and beautiful Python code.</p><h1 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h1><h3 id="OpenPGP-for-Complete-Beginners"><a href="#OpenPGP-for-Complete-Beginners" class="headerlink" title="OpenPGP for Complete Beginners"></a><a href="http://zacharyvoase.com/2009/08/20/openpgp/" target="_blank" rel="noopener">OpenPGP for Complete Beginners</a></h3><p>A good intro to openpgp if you’re a beginner or haven’t heard of it before.</p><h3 id="12-resolutions-for-programmers"><a href="#12-resolutions-for-programmers" class="headerlink" title="12 resolutions for programmers"></a><a href="http://matt.might.net/articles/programmers-resolutions/" target="_blank" rel="noopener">12 resolutions for programmers</a></h3><p>An idea list of new year resolutions for programmers. I really like the ‘Embrace the uncomfortable’ part. Comfort is what kills you - it makes you lazy and dull, and makes your brains decay. It’s a good idea to stimulate it once in a while.</p><p>I do want to learn at least one more new programming language (or maybe pickup Haskell or/and Scheme again?), learn more about security, learn how to use vim, and learn more about non-programming (economics, philosophy, sociology and etc.?).</p><h3 id="The-Bicycle-Problem-How-the-Illusion-of-Explanatory-Depth-Tricks-Your-Brain"><a href="#The-Bicycle-Problem-How-the-Illusion-of-Explanatory-Depth-Tricks-Your-Brain" class="headerlink" title="The Bicycle Problem: How the Illusion of Explanatory Depth Tricks Your Brain"></a><a href="http://www.scotthyoung.com/blog/2015/12/22/illusion-of-explanatory-depth/" target="_blank" rel="noopener">The Bicycle Problem: How the Illusion of Explanatory Depth Tricks Your Brain</a></h3><h3 id="Feynman-Technique-Youtube"><a href="#Feynman-Technique-Youtube" class="headerlink" title="Feynman Technique (Youtube)"></a><a href="https://www.youtube.com/watch?v=FrNqSLPaZLc" target="_blank" rel="noopener">Feynman Technique (Youtube)</a></h3><p>Scott Young explains why we acutally do not understand what we think we understand. And how to really understand by using the ‘Feynman Technique’. </p><h3 id="Start-up-Nation-The-Story-of-Israel’s-Economic-Miracle"><a href="#Start-up-Nation-The-Story-of-Israel’s-Economic-Miracle" class="headerlink" title="Start-up Nation: The Story of Israel’s Economic Miracle"></a><a href="http://www.amazon.com/Start-up-Nation-Israels-Economic-Miracle/dp/0446541478?tag=duckduckgo-d-20" target="_blank" rel="noopener">Start-up Nation: The Story of Israel’s Economic Miracle</a></h3><p>I’ve read the Chinese version of this book. Very interesting insight on Israel and Jewish culture. It basically explains how Israel manage to build such a powerful nation and exert influence on global economics, politics, and technology, with limited resources and hostile environment.</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Frontend&quot;&gt;&lt;a href=&quot;#Frontend&quot; class=&quot;headerlink&quot; title=&quot;Frontend&quot;&gt;&lt;/a&gt;Frontend&lt;/h1&gt;&lt;h3 id=&quot;How-to-set-up-a-Web-development-environment-with-React-Babel-Webpack-and-JavaScript-ES6-Philip-Guo&quot;&gt;&lt;a href=&quot;#How-to-set-up-a-Web-development-environment-with-React-Babel-Webpack-and-JavaScript-ES6-Philip-Guo&quot; class=&quot;headerlink&quot; title=&quot;How to set up a Web development environment with React, Babel, Webpack, and JavaScript ES6 - Philip Guo&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.pgbovine.net/react-babel-webpack-javascript-es6-setup.htm&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;How to set up a Web development environment with React, Babel, Webpack, and JavaScript ES6 - Philip Guo&lt;/a&gt;&lt;/h3&gt;&lt;h3 id=&quot;Minimal-fuss-setup-for-getting-started-with-React-and-JavaScript-ES6&quot;&gt;&lt;a href=&quot;#Minimal-fuss-setup-for-getting-started-with-React-and-JavaScript-ES6&quot; class=&quot;headerlink&quot; title=&quot;Minimal fuss setup for getting started with React and JavaScript ES6&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.pgbovine.net/react-es6-js-setup-minimal.htm&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Minimal fuss setup for getting started with React and JavaScript ES6&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The minimal fuss setup for frontend development, from Philip, one of my favorite professor, programmer and bloggers. &lt;/p&gt;
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
  </entry>
  
  <entry>
    <title>Here Comes Everybody - Book Review</title>
    <link href="https://blog.kevinhu.me/2015/11/30/Here-Comes-Everybody-Book-Review/"/>
    <id>https://blog.kevinhu.me/2015/11/30/Here-Comes-Everybody-Book-Review/</id>
    <published>2015-11-30T06:52:28.000Z</published>
    <updated>2018-03-25T21:29:55.597Z</updated>
    
    <content type="html"><![CDATA[<p>Just finished Clay Shirky’s <a href="https://books.google.com/books/about/Here_Comes_Everybody.html?id=mafZyckH_bAC" target="_blank" rel="noopener"><em>Here Comes Everybody</em></a>, which I think it’s a very interesting book. The author shared his insights on how the Internet effectively gathers the power of people, and how it is rapidly reshaping the society today. Book starts with a story on how Internet helps a lady to regain her lost cellphone with the assistance and pressure from people online, and expands discussion to what why it could happen, and what we should do about it. The world is smaller and people are closer than ever before, for better or worse, because of technologies. In this book, the author carefully analyzed ways Internet could affect our lives, what it means to the world.</p><p>I listed several observations the authors provided in this book, which I find very interesting.</p><a id="more"></a><h2 id="Mass-Amateurization"><a href="#Mass-Amateurization" class="headerlink" title="Mass Amateurization"></a>Mass Amateurization</h2><p>The Internet provides most people the ability to access information from everybody else, which makes everyone a media outlet. It has always been a trend that new technologies lower the barriers of professions, and causes mass amateurization. Just like ancient scribes has been replaced by Gutenberg printing technology, the technological barriers of printing, editing, distributing news and etc. has been lowered by the invention of Internet, and made accessible to the public instead of the elite few, blurring the lines between amateurs and professionals.</p><h2 id="Publish-Then-Filter"><a href="#Publish-Then-Filter" class="headerlink" title="Publish, Then Filter"></a>Publish, Then Filter</h2><p>One outcome of mass amateurization is that the contents provided by the general public is often not of good quality as professionals. However, the accessibility of the Internet has extremely lowered the costs of publishing, and the new form of media has adapted to the ‘publish, then filter’ pattern.</p><h2 id="Power-Law-Distribution"><a href="#Power-Law-Distribution" class="headerlink" title="Power Law Distribution"></a>Power Law Distribution</h2><p>– “Fewer than two percent of the Wikipedia users ever contribute, yet that is enough to create profound value for millions of users.”</p><p>The distribution of participation in large projects always follow power law: the most active contributor contributes ten, to hundreds of times more than average contributors. And the larger the project. This is true for almost all online participants. Most Wikipedia’s pages are contributed by a handful few, but maintained by many users who contribute a few lines, or fix some typos. Most large open source projects are maintained by a few core developers, yet receive small contributions from everywhere. Interestingly, I quote the book: “most large social experiments are engines for harnessing inequality rather than limiting it.”</p><h2 id="Motivation-To-Participate"><a href="#Motivation-To-Participate" class="headerlink" title="Motivation To Participate"></a>Motivation To Participate</h2><p>Before Wikipedia the founders started off their ideas of an open online encyclopedia by creating a site called <a href="https://en.wikipedia.org/wiki/Nupedia" target="_blank" rel="noopener">Nupedia</a>, with contents contributed from experts only. Apparently this experiment failed, but the succeeding non-profit, volunteer-only Wikipedia soon gained popularity. One of the many interesting questions about Wikipedia is: what gave people the motivation to contribute?</p><p>The author’s answer is: the love to Wikipedia. ‘When people care enough, they can come together and accomplish things of a scope and longevity that were previously impossible; they can do big things for love.”</p><p>Wikipedia provides a power engine (the wiki engine) to protect the love from contributors. Wiki allows revisions and histories, thus made iterative improvements possible, and at the same maintains history versions to keep wiki pages from catastrophic damages from evil-minded people. Together they are indispensable ingredients to Wikipedia’s success.</p><h2 id="Promise-Tool-Bargain"><a href="#Promise-Tool-Bargain" class="headerlink" title="Promise, Tool, Bargain"></a>Promise, Tool, Bargain</h2><p>“The order of promise, tool, and bargain is also the order in which they matter most to the success of any given group.”</p><p>The promise of a group provides the ideology for one group and is the main reason why people are willing to participate. It sets the tone for this group activity. “Let’s try to see if we can come up with something together”, is actually the very first promise Torvalds put in the mail introducing his toy OS Linux. It was not as sweeping as a promise like “Let’s make a world-changing Operating System together” (although it did at last), but it provides just enough interest to people for this small infant project.</p><p>Tools define how interactions happen among the groups, setting tones for interactions. A wiki is good for shared knowledge and judgment, while a mailing list is more convenient for open discussions.</p><p>The bargain is more like the adjustment to the culture inside one group. “We expect politeness of one another, and we rebuke the impolite” is a bargain’s most likely creating a culture which is friendly and respecting.</p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>This is an interesting book on how large groups, especially groups on Internet works, and how the “wisdom of the crowd” is collected, and should be collected. As my energy is so limited, I can’t even list out all the important ideas in it. This post is my best effort. Anyone who’s interested in building a society online might benefit from this book. In all it might be interesting to take a look at.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Just finished Clay Shirky’s &lt;a href=&quot;https://books.google.com/books/about/Here_Comes_Everybody.html?id=mafZyckH_bAC&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;em&gt;Here Comes Everybody&lt;/em&gt;&lt;/a&gt;, which I think it’s a very interesting book. The author shared his insights on how the Internet effectively gathers the power of people, and how it is rapidly reshaping the society today. Book starts with a story on how Internet helps a lady to regain her lost cellphone with the assistance and pressure from people online, and expands discussion to what why it could happen, and what we should do about it. The world is smaller and people are closer than ever before, for better or worse, because of technologies. In this book, the author carefully analyzed ways Internet could affect our lives, what it means to the world.&lt;/p&gt;
&lt;p&gt;I listed several observations the authors provided in this book, which I find very interesting.&lt;/p&gt;
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
      <category term="Internet, BookReview" scheme="https://blog.kevinhu.me/tags/Internet-BookReview/"/>
    
  </entry>
  
  <entry>
    <title>Reading Summary 2015-11</title>
    <link href="https://blog.kevinhu.me/2015/11/11/Reading-Summary-2015-11/"/>
    <id>https://blog.kevinhu.me/2015/11/11/Reading-Summary-2015-11/</id>
    <published>2015-11-12T05:20:46.000Z</published>
    <updated>2018-03-25T21:29:55.653Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Compilers"><a href="#Compilers" class="headerlink" title="Compilers"></a>Compilers</h1><h3 id="Directed-graph-traversal-orderings-and-applications-to-data-flow-analysis"><a href="#Directed-graph-traversal-orderings-and-applications-to-data-flow-analysis" class="headerlink" title="Directed graph traversal, orderings and applications to data-flow analysis"></a><a href="http://eli.thegreenplace.net/2015/directed-graph-traversal-orderings-and-applications-to-data-flow-analysis/" target="_blank" rel="noopener">Directed graph traversal, orderings and applications to data-flow analysis</a></h3><p>On the graph traversal and their efficiency.</p><ul><li>Pre-order depth-first-search</li><li>Reverse post-order depth-first-search</li></ul><p>This could be a very helpful reference when designing data-flow analysis on programs.</p><h1 id="Programming"><a href="#Programming" class="headerlink" title="Programming"></a>Programming</h1><h3 id="Semantic-Version"><a href="#Semantic-Version" class="headerlink" title="Semantic Version"></a><a href="http://semver.org/" target="_blank" rel="noopener">Semantic Version</a></h3><p>How to use version numbers in a sensible way: the MAJOR.MINOR.PATCH format. And I quote:</p><blockquote><ol><li>MAJOR version when you make incompatible API changes.</li><li>MINOR version when you add functionality in a backwards-compatible manner.</li><li>PATCH version when you make backwards-compatible bug fixes.</li></ol></blockquote><h1 id="Internet"><a href="#Internet" class="headerlink" title="Internet"></a>Internet</h1><h3 id="I’m-a-Privacy-Advocate-but-I-Still-Use-Windows-10-and-Google-Now"><a href="#I’m-a-Privacy-Advocate-but-I-Still-Use-Windows-10-and-Google-Now" class="headerlink" title="I’m a Privacy Advocate, but I Still Use Windows 10 and Google Now"></a><a href="http://lifehacker.com/im-a-privacy-advocate-but-i-still-use-windows-10-and-g-1723611163" target="_blank" rel="noopener">I’m a Privacy Advocate, but I Still Use Windows 10 and Google Now</a></h3><p>Your personal data is the fuel to power the Internet today, and how should we face it.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Compilers&quot;&gt;&lt;a href=&quot;#Compilers&quot; class=&quot;headerlink&quot; title=&quot;Compilers&quot;&gt;&lt;/a&gt;Compilers&lt;/h1&gt;&lt;h3 id=&quot;Directed-graph-traversal-orderings-an
      
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
  </entry>
  
  <entry>
    <title>Reading Summary in 2015/10</title>
    <link href="https://blog.kevinhu.me/2015/10/24/Reading-Summary-in-2015-10/"/>
    <id>https://blog.kevinhu.me/2015/10/24/Reading-Summary-in-2015-10/</id>
    <published>2015-10-24T06:38:05.000Z</published>
    <updated>2018-03-25T21:29:55.701Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Compilers"><a href="#Compilers" class="headerlink" title="Compilers"></a>Compilers</h1><h3 id="Troubles-with-GCC-signed-integer-overflow-optimization"><a href="#Troubles-with-GCC-signed-integer-overflow-optimization" class="headerlink" title="Troubles with GCC signed integer overflow optimization"></a><a href="http://thiemonagel.de/2010/01/signed-integer-overflow/" target="_blank" rel="noopener">Troubles with GCC signed integer overflow optimization</a></h3><h3 id="BUG-30475-assert-int-100-gt-int-optimized-away"><a href="#BUG-30475-assert-int-100-gt-int-optimized-away" class="headerlink" title="BUG 30475 - assert(int+100&gt;int) optimized away"></a><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=30475" target="_blank" rel="noopener">BUG 30475 - assert(int+100&gt;int) optimized away</a></h3><p>An interesting ‘bug’ in some versions of GCC (and Clang as well) implementation. Since it’s <strong>‘undefined’</strong> behavior after all, compiler is not obliged to implement it as a defined behavior. Use <code>-fwrapv</code> flag in GCC to inform the compiler that integer value wraps.</p><h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><h3 id="Profiling-Python-in-Production"><a href="#Profiling-Python-in-Production" class="headerlink" title="Profiling Python in Production"></a><a href="https://nylas.com/blog/performance" target="_blank" rel="noopener">Profiling Python in Production</a></h3><p>Signal timeout for every small amount of time (say, 1ms in this case) and record the current stack, and we can infer time spent in each function precisely enough. A smart way of profiling large Python programs.</p><p>Note: python signal callback passes signal type and signal handler, and signal handler takes signal number and current stack frame.</p><h3 id="Hitchhiker’s-Guide-to-Python"><a href="#Hitchhiker’s-Guide-to-Python" class="headerlink" title="Hitchhiker’s Guide to Python"></a><a href="http://docs.python-guide.org/en/latest/" target="_blank" rel="noopener">Hitchhiker’s Guide to Python</a></h3><p>Great book to Python, covering code style, best practices and scenario guide. Just started reading it.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Compilers&quot;&gt;&lt;a href=&quot;#Compilers&quot; class=&quot;headerlink&quot; title=&quot;Compilers&quot;&gt;&lt;/a&gt;Compilers&lt;/h1&gt;&lt;h3 id=&quot;Troubles-with-GCC-signed-integer-over
      
    
    </summary>
    
      <category term="Reading" scheme="https://blog.kevinhu.me/categories/Reading/"/>
    
    
      <category term="Python" scheme="https://blog.kevinhu.me/tags/Python/"/>
    
      <category term="Compilers" scheme="https://blog.kevinhu.me/tags/Compilers/"/>
    
  </entry>
  
  <entry>
    <title>A Small Discovery In C Linker</title>
    <link href="https://blog.kevinhu.me/2015/04/16/A-Small-Discovery-In-C/"/>
    <id>https://blog.kevinhu.me/2015/04/16/A-Small-Discovery-In-C/</id>
    <published>2015-04-17T04:01:33.000Z</published>
    <updated>2018-03-25T21:29:55.688Z</updated>
    
    <content type="html"><![CDATA[<p>C language is an old-school programming language, learned by almost all professional programmers. Still, it never failed to surprise me each time I dig in a little deeper, as it’s full of small details, some hardly noticed, such as this one I recently discovered by accident.</p><a id="more"></a><p>Consider the following two C files:</p><p>foo.c:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">void foo(int c, int d, int e)</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;The param is %d, %d, %d\n&quot;, c, d, e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>main.c:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">int foo(char c);</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int a = foo(100);</span><br><span class="line"></span><br><span class="line">    printf(&quot;The return value of foo is %d\n&quot;, a);</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>At first sight, you’d probably laugh and think: “What the heck is this? There are some very elementary mistakes that a CS101 student wouldn’t even make. They definitely wouldn’t compile.”</p><p>Is it really so?</p><p>Try the following command to compile them:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gcc hello.c foo.c -o hello</span><br></pre></td></tr></table></figure><p>Or if you’re an LLVM fan:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ clang hello.c foo.c -o hello</span><br></pre></td></tr></table></figure><p>How do they complain?</p><p>None. I’ve tested this on my Linux Ubuntu machine with gcc-4.8, gcc-4.9, and clang-3.5. None of them complained a thing. They got successfully compiled!</p><p>Surprise? Not really. If you’re a expert in C and how compiler works, you’d think it’s quite normal. Well, I’m not. So I was quite astonished when I first saw this.</p><p>Why would this happen? </p><p>Well. Simply put, it’s because C linkers don’t do type checking for functions. C files are first compiled into object files, exposing external symbol names for the linker. In this particular case, <code>main.c</code> exposes <code>main</code> function definition and <code>foo</code> function declaration, and <code>foo.c</code> exposes <code>foo</code> function definition. When the C linker notice <code>foo</code> is only a declaration in <code>main.c</code>, it would search for its definitions in all the externally exposed symbols in all object files, and it finds a hit in the object file that <code>foo.c</code> compiles to. As the function symbol in the object file records function names only, no return type or parameter type checking is done. The linker happily accepts this unmatching <code>foo</code> as a match and use it in main function.</p><p>Somehow, C++ does name mangling to preserve function types and any type unmatching for functions could be avoided. This won’t compile for any C++ compilers. Try g++ or clang++. Some other compilers or IDEs with static checkings may also notice this error.</p><p>So, what would happen if you actually run it?</p><p>I got the following results in one run:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The param is 100, -1549285384, -1549285368</span><br><span class="line">The return value of foo is 43</span><br></pre></td></tr></table></figure><p>It’s easy to understand the 100 output. The following two shall be the value of d and e. And as <code>main</code> doesn’t pass any parameters, the <code>foo</code> function will happily read whatever on the program stack where these two parameters should be. And in this case, it shall be garbage.</p><p>And what about that 43 returned from the <code>foo</code> function? That doesn’t look like garbage. Actually if you run this broken piece of program for enough times, you’ll notice this value is always somewhat around 30~50. So this mysterious number could be something more than garbage. Is it the meaning to your life? No, that’s 42. Is it something <a href="http://bigbangtheory.wikia.com/wiki/The_43_Peculiarity" target="_blank" rel="noopener">on the wall of Sheldon’s secret room</a>? Probably.</p><p>So what is it exactly?</p><p>After poking around in gdb for a while, I confirmed my guess that this is actually the return value of <code>printf</code> inside of <code>foo</code>. As on x86 machines, most of the time C program uses <code>eax</code> register to carry return values, <code>main</code> function loads <code>a</code>‘s value from <code>eax</code> when it tries to read the return value of <code>foo</code>. As <code>foo</code> has void return type, this register is untampered after return of <code>printf</code> inside <code>foo</code>, and saved directly to integer <code>a</code> in <code>main</code>.</p><p>The following is the dump inside gdb. This time I have 31 as <code>foo</code>‘s return value.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Run till exit from #0  __printf (format=0x400637 &quot;The param is %d, %d, %d\n&quot;) at printf.c:32</span><br><span class="line">The param is 100, -7816, -7800</span><br><span class="line">foo (c=100, d=-7816, e=-7800) at foo.c:6</span><br><span class="line">6       &#125;</span><br><span class="line">Value returned is $1 = 31</span><br><span class="line">(gdb) info registers</span><br><span class="line">info registers</span><br><span class="line">rax            0x1f     31</span><br><span class="line">rbx            0x0      0</span><br><span class="line">rcx            0x1e     30</span><br><span class="line">(gdb) info register eax</span><br><span class="line">info register eax</span><br><span class="line">eax            0x1f     31</span><br></pre></td></tr></table></figure><p>We all know the return value of <code>printf</code> is the number of characters written to the stdout. So, the mysterious return value is actually the number of characters printed out in the first sentence. You can count to confirm, and don’t forget the return character.</p><h2 id="Afterthoughts"><a href="#Afterthoughts" class="headerlink" title="Afterthoughts"></a>Afterthoughts</h2><p>I remember someone joked that C is but a high-level syntax sugar for assembly. Now it looks to me that it’s also low level enough that it exposes lots of features in assembly. It’s never an easy task to understand all these very little details of C, as well as any other languages, but it’s probably a must if one wishes to become a qualified programmer in it.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;C language is an old-school programming language, learned by almost all professional programmers. Still, it never failed to surprise me each time I dig in a little deeper, as it’s full of small details, some hardly noticed, such as this one I recently discovered by accident.&lt;/p&gt;
    
    </summary>
    
      <category term="ProgrammingLanguage" scheme="https://blog.kevinhu.me/categories/ProgrammingLanguage/"/>
    
    
      <category term="C" scheme="https://blog.kevinhu.me/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>BitHacks</title>
    <link href="https://blog.kevinhu.me/2015/03/07/Bithacks/"/>
    <id>https://blog.kevinhu.me/2015/03/07/Bithacks/</id>
    <published>2015-03-08T03:22:30.000Z</published>
    <updated>2018-03-25T21:29:55.677Z</updated>
    
    <content type="html"><![CDATA[<p>I’ve recently come across a very interesting article on <a href="https://graphics.stanford.edu/~seander/bithacks.html" target="_blank" rel="noopener">BitHacks</a> – the low level magics for bit level operations. Some of the tricks introduced here are really excellently clever, some of them may even make you exclaim for their genius!</p><p>I had a lot of fun reading through some of the BitHacks. It’s also worth noticing these BitHacks are not only for intellectual pleasures, they provide actual boosts to algorithm performance as well. When an operations is used often enough, the overall performance benefits to the whole program might be significant.</p><p>I couldn’t help but keep wondering how on earth did these clever CS guys ever come up with such algorithms. I tried very hard to find some answers and the following are some patterns I noticed in this attempt. Still, honestly, I highly doubt if I can come up with same solutions myself if I ever run into these problems again. Some of them are just to clever.</p><a id="more"></a><h2 id="Some-examples"><a href="#Some-examples" class="headerlink" title="Some examples"></a>Some examples</h2><ul><li><a href="https://graphics.stanford.edu/~seander/bithacks.html#CopyIntegerSign" target="_blank" rel="noopener">Compute the sign of an integer</a></li></ul><p>The beauty part of bit hackings is that most of the times they avoid branching in CPU, which could be expensive for modern pipelining CPUs, as a misprediction in branching means flushing operations, causing waste in time and power.</p><p>For example, to compute the sign of an integer, instead of using branching, we can use the following code:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> v;       <span class="comment">// the integer</span></span><br><span class="line"><span class="keyword">int</span> sign;    <span class="comment">// the sign of the integer</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// CHAR_BIT is the number of bits per byte (normally 8). </span></span><br><span class="line"><span class="comment">// But for compatibility issues, here uses CHAR_BIT instead.</span></span><br><span class="line"></span><br><span class="line">sign = - (v &lt; <span class="number">0</span>);   <span class="comment">// sign = -1 when v is negative</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// return -1 when v is negative, 0 when 0, and 1 when positive:</span></span><br><span class="line"><span class="comment">// cast v to be unsigned, right shift the sign bit to the LSB, cast it back</span></span><br><span class="line"><span class="comment">// to integer, and assign the sign.</span></span><br><span class="line">sign = (v != <span class="number">0</span>) | -(<span class="keyword">int</span>)((<span class="keyword">unsigned</span>)((<span class="keyword">int</span> v) &gt;&gt; (<span class="keyword">sizeof</span>(<span class="keyword">int</span>) * CHAR_BIT - <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Or for better speed</span></span><br><span class="line">sign = (v &gt; <span class="number">0</span>) - (v &lt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure><ul><li><a href="https://graphics.stanford.edu/~seander/bithacks.html#DetermineIfPowerOf2" target="_blank" rel="noopener">Determine if integer is power of 2</a></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// One interesting feature of an integer to the power of 2:</span></span><br><span class="line"><span class="comment">// v &amp; (v - 1) == 0</span></span><br><span class="line"><span class="comment">// 0 is also incorrectly considered to be a power of 2 with</span></span><br><span class="line"><span class="comment">// the above equation, but the fix is simple</span></span><br><span class="line"></span><br><span class="line">f = v &amp;&amp; !(v &amp; (v - <span class="number">1</span>));</span><br></pre></td></tr></table></figure><ul><li><a href="https://graphics.stanford.edu/~seander/bithacks.html#IntegerMinOrMax" target="_blank" rel="noopener">Find the min or max of two integers</a>.</li></ul><p>The effect shall be the same as</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">max = x &gt; y ? x : y;</span><br><span class="line">min = x &lt; y ? x : y;</span><br></pre></td></tr></table></figure><p>Somehow the above approach also use branch to determine value. A BitHack way is to:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = x ^ ((x ^ y) &amp; -(x &lt; y));</span><br></pre></td></tr></table></figure><p>Amazing! Isn’t it? Here when x &lt; y, -(x &lt; y) evaluates to -1, which is all 1s in binary representation. The result will then evaluates to:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x ^ (x ^ y)</span><br></pre></td></tr></table></figure><p>Which is y. While when x &gt; y, -(x &lt; y) evaluates to 0, and the result will be assigned x.</p><p>This is a very interesting feature of the XOR operation. Remember how XOR could be used to exchange the value of two numbers without extra memory:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = a ^ b;</span><br><span class="line">b = a ^ b;  <span class="comment">// (a ^ b) ^ b</span></span><br><span class="line">a = a ^ b;  <span class="comment">// (a ^ b) ^ a</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Here a and b are exchanged</span></span><br></pre></td></tr></table></figure><p>XOR has many interesting features, and is a very important operations in BitHacks. Here’s another example.</p><ul><li><a href="https://graphics.stanford.edu/~seander/bithacks.html#IntegerAbs" target="_blank" rel="noopener">Absolute value of an integer</a></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mask = v &gt;&gt; (<span class="keyword">sizeof</span>(<span class="keyword">int</span>) * CHAR_BIT - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">result = (v + mask) ^ mask;</span><br></pre></td></tr></table></figure><p>When v is positive, mask is 0, result will be assigned v. And when v is negative, mask will evaluate to -1 (all 1s in binary), and the result will be (v - 1) ^ (-1). As XORing all 1s gives the NOT of an integer (v ^ -1 == ~v), the result becomes ~(v - 1). Not surprisingly, this is the negative value of v.</p><p>An alternative but similar approach is:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = (v ^ mask) - mask;</span><br></pre></td></tr></table></figure><h2 id="Some-Observations"><a href="#Some-Observations" class="headerlink" title="Some Observations"></a>Some Observations</h2><p>I believe some general guidelines could be useful for inventing our own BitHacks could be useful, but the post did not mention any special techniques, and some of the hacks seems really ad-hoc (sure, that’s why they’re called “hacks”, right?). Nevertheless, the following is some observations I had when reading. Keeping these in mind might help the next time when inventing BitHacks.</p><h3 id="Use-AND-OR-shift-and-masking"><a href="#Use-AND-OR-shift-and-masking" class="headerlink" title="Use AND, OR, shift and masking"></a>Use AND, OR, shift and masking</h3><p>Use AND to clear the bit field, OR to set the bit field, and use shift to move important bit to the right position. Use a carefully designed mask to clear or set the fields.</p><p>An excellent example could be found in <a href="https://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetParallel" target="_blank" rel="noopener">here: counting bit set, in parallel</a>.</p><p>In the example, instead of iterating all the bit fields in the given integer, we could use a mask to mask the fields, and merge the all the counts, a bit like reduce in the map-reduce. In this way, no loops are required to count the bit sets.</p><p>The operations could be explained as follows:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// first, I randomly pick a 32-bit integer to count bits set</span></span><br><span class="line"><span class="comment">// value: 0110 1000 1011 0100  0101 1001 1011 1110</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// MASK1: 0101 0101 0101 0101  0101 0101 0101 0101</span></span><br><span class="line"><span class="comment">//         1 0  0 0  0 1  1 0   1 1  0 1  0 1  1 0</span></span><br><span class="line"><span class="comment">// +       0 1  1 0  1 1  0 0   0 0  1 0  1 1  1 1</span></span><br><span class="line"><span class="comment">// c   :  0101 0100 0110 0100  0101 0101 0110 1001</span></span><br><span class="line"><span class="comment">// The idea is to find the bit counts for every two bits.</span></span><br><span class="line"><span class="comment">// To achieve so, using mask and shift, we can shift the value</span></span><br><span class="line"><span class="comment">// 1 to the right and add the masked original value together,</span></span><br><span class="line"><span class="comment">// as following:</span></span><br><span class="line"></span><br><span class="line">c = ((v &gt;&gt; <span class="number">1</span>) &amp; MASK0) + (v &amp; MASK0);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Although here the post uses a faster way;</span></span><br><span class="line"><span class="comment">// c = v - ((v &gt;&gt; 1) &amp; MASK0);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Then add the counts for each 4 bits. The mask becomes:</span></span><br><span class="line"><span class="comment">// MASK1: 0011 0011 0011 0011  0011 0011 0011 0011</span></span><br><span class="line"></span><br><span class="line">c = ((c &gt;&gt; <span class="number">2</span>) &amp; MASK1) + (c &amp; MASK1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// After this operation, then find the count in every 8 bits,</span></span><br><span class="line"><span class="comment">// and every 16 bits, and every 32 bits. The final count would</span></span><br><span class="line"><span class="comment">// be what we want.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// MASK2: 0000 1111 0000 1111  0000 1111 0000 1111</span></span><br><span class="line"><span class="comment">// MASK3: 0000 0000 1111 1111  0000 0000 1111 1111</span></span><br><span class="line"><span class="comment">// MASK4: 0000 0000 0000 0000  1111 1111 1111 1111</span></span><br><span class="line"></span><br><span class="line">c = ((c &gt;&gt; <span class="number">4</span>) &amp; MASK2) + (c &amp; MASK2);</span><br><span class="line">c = ((c &gt;&gt; <span class="number">8</span>) &amp; MASK3) + (c &amp; MASK3);</span><br><span class="line">c = ((c &gt;&gt; <span class="number">16</span>) &amp; MASK4) + (c &amp; MASK4);</span><br></pre></td></tr></table></figure><h3 id="XOR-operation"><a href="#XOR-operation" class="headerlink" title="XOR operation"></a>XOR operation</h3><p>The XOR operation has many interesting features which could be used cleverly in BitHacks.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> value, other;</span><br><span class="line"></span><br><span class="line">value ^ <span class="number">0</span> == value;</span><br><span class="line">value ^ <span class="number">0xFFFFFFFF</span> == ~value;</span><br><span class="line">value ^ (<span class="number">-1</span>) == ~value;           <span class="comment">// same as above</span></span><br><span class="line">value ^ value == <span class="number">0</span></span><br><span class="line">value ^ (value ^ other) == other;</span><br></pre></td></tr></table></figure><p>The previous, and some following examples all uses these features to efficiently “hack the bits”. For example: exchanging values without extra memory, finding absolute value, finding the min or max of two values.</p><h3 id="Two’s-complements"><a href="#Two’s-complements" class="headerlink" title="Two’s complements"></a>Two’s complements</h3><p>In the previous example: Absolute value of an integer, a mask was used to conditionally find the original and the negative value, by setting the mask to either 0 or all 1s, which is -1 in integer representation. The negative value of v could be found by very simple operations:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">v = ~v + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// here to find the value of ~v, one could use v ^ -1.</span></span><br><span class="line"><span class="comment">// And since (v ^ 0 == v), we can easily come up with</span></span><br><span class="line"><span class="comment">// the solution to find the abs of v.</span></span><br><span class="line"></span><br><span class="line">v = (v ^ mask) - mask</span><br><span class="line"></span><br><span class="line"><span class="comment">// or its alternative, as described previously</span></span><br><span class="line">v = (v + mask) ^ mask</span><br></pre></td></tr></table></figure><p>Taking advantage of this property, we can also come up with a way to <a href="https://graphics.stanford.edu/~seander/bithacks.html#ConditionalNegate" target="_blank" rel="noopener">conditionally negate a value</a>:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = (v ^ -flag) + flag;</span><br></pre></td></tr></table></figure><h3 id="Lookup-table"><a href="#Lookup-table" class="headerlink" title="Lookup table"></a>Lookup table</h3><p>A lot of complicated operations could be accomplished by using lookup tables, one example could be the counting bits set as above. Some other examples includes:</p><ul><li><a href="https://graphics.stanford.edu/~seander/bithacks.html#ParityLookupTable" target="_blank" rel="noopener">Compute parity by lookup table</a></li><li><a href="https://graphics.stanford.edu/~seander/bithacks.html#BitReverseTable" target="_blank" rel="noopener">Reverse bits lookup table</a></li><li><a href="https://graphics.stanford.edu/~seander/bithacks.html#IntegerLogLookup" target="_blank" rel="noopener">Find the log base 2 of an integer with a lookup table</a></li></ul><p>Although it might take up more space for memory, it’s often worthwhile to trade some amount of memory for speed. Memory operations may be more expensive, but considering prefetching is now prevalent in modern CPUs, fetching data from the cache is way faster than a misprediction in branch operations. </p><h2 id="Afterthoughts"><a href="#Afterthoughts" class="headerlink" title="Afterthoughts"></a>Afterthoughts</h2><p>There are many other interesting and mind-opening techniques, tricks and hacks to speed up your program in <a href="https://graphics.stanford.edu/~seander/bithacks.html#CopyIntegerSign" target="_blank" rel="noopener">this post</a>. I have a hunch that I might actually use some of them in the future, or come up with my own BitHacks with similar mindset. Before this, I didn’t even realize I could play with bit operations in C/C++ this way. Also, <a href="https://graphics.stanford.edu/~seander/bithacks.html#CopyIntegerSign" target="_blank" rel="noopener">this post</a> could serve as a great reference when a performance critical part needs optimization with BitHacks.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;I’ve recently come across a very interesting article on &lt;a href=&quot;https://graphics.stanford.edu/~seander/bithacks.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BitHacks&lt;/a&gt; – the low level magics for bit level operations. Some of the tricks introduced here are really excellently clever, some of them may even make you exclaim for their genius!&lt;/p&gt;
&lt;p&gt;I had a lot of fun reading through some of the BitHacks. It’s also worth noticing these BitHacks are not only for intellectual pleasures, they provide actual boosts to algorithm performance as well. When an operations is used often enough, the overall performance benefits to the whole program might be significant.&lt;/p&gt;
&lt;p&gt;I couldn’t help but keep wondering how on earth did these clever CS guys ever come up with such algorithms. I tried very hard to find some answers and the following are some patterns I noticed in this attempt. Still, honestly, I highly doubt if I can come up with same solutions myself if I ever run into these problems again. Some of them are just to clever.&lt;/p&gt;
    
    </summary>
    
      <category term="Algorithm" scheme="https://blog.kevinhu.me/categories/Algorithm/"/>
    
    
      <category term="BitHacks" scheme="https://blog.kevinhu.me/tags/BitHacks/"/>
    
  </entry>
  
  <entry>
    <title>Algorithm I Summary</title>
    <link href="https://blog.kevinhu.me/2015/01/10/Algorithm-I-Summary/"/>
    <id>https://blog.kevinhu.me/2015/01/10/Algorithm-I-Summary/</id>
    <published>2015-01-10T07:54:07.000Z</published>
    <updated>2018-03-25T21:29:55.665Z</updated>
    
    <content type="html"><![CDATA[<p>Finally! Just finished all the lecture videos of “Algorithm I” from Coursera, and I believe now it’s a good time to review and summarize.<a id="more"></a></p><p>All contents are based on Coursera course slides, as well as other helpful sites (Wikipedia, StackOverflow, <a href="http://algs4.cs.princeton.edu/home/" target="_blank" rel="noopener">Algorithm - 4th Edition</a> from Princeton U). All pictures are from the slides and the <a href="http://algs4.cs.princeton.edu/home/" target="_blank" rel="noopener">Algorithm - 4th Edition</a>.</p><h2 id="Stacks-and-Queues"><a href="#Stacks-and-Queues" class="headerlink" title="Stacks and Queues"></a>Stacks and Queues</h2><p>Stacks and Queues are probably the most commonly seen data structures seen in the software. Stacks are “First-In-Last-Out”, while Queues are “First-In-First-Out”. The basic operations they support are push() and pop().</p><p>The underlying implementations could be linked-list, arrays and etc.. Linked list provides with more flexible memory management, constant time operations, but brings more time overhead and memory overhead for the link operations. Arrays on the other hand, brings tricky issues of resizing, but the operations are also constant time, and has less memory overheads.</p><h2 id="Priority-Queues-and-Heaps"><a href="#Priority-Queues-and-Heaps" class="headerlink" title="Priority Queues and Heaps"></a>Priority Queues and Heaps</h2><h3 id="Priority-Queues"><a href="#Priority-Queues" class="headerlink" title="Priority Queues"></a>Priority Queues</h3><p>Although often mentioned together, Priority Queue and Heap are <a href="http://en.wikipedia.org/wiki/Priority_queue" target="_blank" rel="noopener">different concepts</a>. Priority Queue is an abstract data type which is like a queue or stack data structure, but is often implemented in heaps, just like lists could be implemented as arrays or linked lists.</p><p>Priority Queue, as its name suggests, could give the element with highest priority. Usually it requires O(1) performance for this operation as it’s crucial to many applications, to name a few (From course slides):</p><ul><li>Event-driven simulation [give the next event for simulation]</li><li>Graph searching [Dijkstra’s Algorithm]</li><li>Data compression</li><li>Statistics [Maintain largest M values]</li><li>Operating Systems [Load balancing, interrupt handling]</li><li>…</li></ul><h3 id="Heap"><a href="#Heap" class="headerlink" title="Heap"></a>Heap</h3><p>Binary Heap is one most common implementation of Priority Heap. It uses a binary tree to maintain the data relationship, and could be implemented with arrays. As shown below. (Picture from slide of <a href="https://class.coursera.org/algs4partI-006" target="_blank" rel="noopener">Coursera Algorithm I Course</a>).</p><p><img src="HeapRepresentation.png" alt="Binary Heap Representation"></p><p>A Binary Heap has the following properties:</p><ul><li>Is a complete binary tree.</li><li>Largest key is root node of binary tree, which is represented as list[1].</li><li>In array representation, the 0 node is often a dummy node, therefore,</li><li>Parent of node k is at k/2.</li><li>Children of node k are at 2k and 2k+1</li></ul><p>The following operations are supported by Binary Heap:</p><ul><li><p><strong>Insertion</strong>: To insert, add a node at the end, then swim it up. Meaning: keep comparing it with its parent, if larger than parent, then switch position with it.</p></li><li><p><strong>Deletion</strong>: Binary heap supports deletion from the root node (extract the max element). It removes the root node, then replace the root node with the last element on the last level, then sink it. Meaning: keep switching position with the larger one of its children. </p></li></ul><p>Binary Heaps, both insertion and deletion takes O(logN) time to swim or sink, which makes finding max M elements in N O(MlogN).</p><p>For Heap Sort, I’d like to categorize it together with all the sorting algorithms, described as following.</p><h2 id="Sorting-Algorithms"><a href="#Sorting-Algorithms" class="headerlink" title="Sorting Algorithms"></a>Sorting Algorithms</h2><h2 id="Elementary-Sort"><a href="#Elementary-Sort" class="headerlink" title="Elementary Sort"></a>Elementary Sort</h2><p>The elementary sorting algorithm part introduces <strong>Insertion Sort</strong>, <strong>Selection Sort</strong>, along with <strong>Shell Sort</strong>.</p><p><strong>Selection Sort</strong>: As name suggests, selection sort traverse the unsorted part of the list to find the minimum element, and put it in the front of the unsorted part, and consider this element sorted.</p><p>Selection Sort has O(N^2) of average time complexity, even when the list is almost sorted.</p><p><strong>Insertion Sort</strong>: For each element, keep comparing it to the element in front of it and switch position if it’s smaller than the front element, until it’s the larger one.</p><p>It has O(N^2) of average time complexity as well, but only ~N operations when the list is almost sorted, which makes it actually quite useful in certain cases.</p><p><strong>Shell Sort</strong>: The algorithm starts with sorting elements h elements apart with insertion sort, then keep decreasing h to have the list “h-sorted”, until h reaches 1, and the whole list is sorted.</p><p>With these two gap sequences, Shell Sort is known to have <a href="http://www.sorting-algorithms.com/shell-sort" target="_blank" rel="noopener">O(N^3/2) average time complexity</a>, <a href="http://www.sorting-algorithms.com/shell-sort" target="_blank" rel="noopener">O(Nlog(N)) time complexity</a> for nearly sorted lists, which gives it pretty good performance.The value of the gap h is commonly chosen by 3k+1, or an experiment found array of [1, 4, 10, 23, 57, 132, 301, 701]. Also as it doesn’t require function calls, it’s actually used in many cases such as embedded systems, and Linux kernel.</p><h3 id="Merge-Sort"><a href="#Merge-Sort" class="headerlink" title="Merge Sort"></a>Merge Sort</h3><p>Merge Sort is best described recursively. It takes the following procedures to the list of elements:</p><ul><li>Divide array into two halves.</li><li>Recursively divide and sort each half.</li><li>Merge two halves in order.</li></ul><p>One important feature of Merge Sort is that, it takes O(N) of extra memory space. Also, it has so much overhead for tiny subarrays. Therefore, for small sized subarrays, Merge Sort could use Insertion Sort for speed up.</p><p>Time complexity for Merge Sort is O(NlogN). It is stable - meaning previously sorted items would not be rearranged by new sorts.</p><h3 id="Quick-Sort"><a href="#Quick-Sort" class="headerlink" title="Quick Sort"></a>Quick Sort</h3><p>The steps for quick sort are as follows:</p><ul><li>Choose an element of the list to be the pivot.</li><li>Put all elements smaller than the pivot to the left, elements larger than the pivot to the right.</li><li>Recursively sort the left and right partition.</li><li>Join the left, pivot, and the right.</li></ul><p>Quick Sort, as its name suggests, has the <a href="http://rosettacode.org/wiki/Sorting_algorithms/Quicksort" target="_blank" rel="noopener">reputation for the fastest sort</a>. It has O(NlogN) time complexity, although for certain inputs and bad pivot selection (e.g. a sorted list and first element for pivot), the worst case could be O(N^2). Also, for small subarrays, Quick Sort could use Insertion Sort to reduce overhead.</p><p>One problem with Quick Sort is that its performance decreases when dealing with lists with many identical elements. This could be solved by a variation: The 3 way Quick Sort, which separates the list into 3 separations of less-than, equal, and larger than.</p><p>Quick Sort is known as fast, and is therefore widely used in many system applications.</p><h3 id="Heap-Sort"><a href="#Heap-Sort" class="headerlink" title="Heap Sort"></a>Heap Sort</h3><p>The idea for Heap Sort is to create a heap with all the keys, and repeatedly remove the max key. As described above, when the max value is deleted, the last element replaces the root node, and sunk down to the appropriate place.</p><p>One significant feature of Heap Sort is that: it has O(NlogN) worst-case performance. But (From Course Slides):</p><ul><li>Inner loop longer than Quick Sort.</li><li>Cache unfriendly.</li><li>Not stable.</li></ul><h3 id="Summary-for-Sorting"><a href="#Summary-for-Sorting" class="headerlink" title="Summary for Sorting"></a>Summary for Sorting</h3><p>There is an website introducing the details of different sorting algorithms, with sorting animations: <a href="http://www.sorting-algorithms.com/" target="_blank" rel="noopener">http://www.sorting-algorithms.com/</a> . The following table summarizes some of the common sorting algorithms.</p><table><thead><tr><th>Algorithm</th><th>Average Time</th><th>Worst Time</th><th>Extra Space</th><th>Adaptive</th><th>Stable</th></tr></thead><tbody><tr><td>Selection Sort</td><td>O(N^2)</td><td>O(N^2)</td><td>O(1)</td><td>No</td><td>No</td></tr><tr><td>Insertion Sort</td><td>O(N^2)</td><td>O(N^2)</td><td>O(1)</td><td>Yes</td><td>Yes</td></tr><tr><td>Shell Sort</td><td>O(N^3/2)</td><td>O(N^2)</td><td>O(1)</td><td>Yes</td><td>No</td></tr><tr><td>Merge Sort</td><td>O(NlogN)</td><td>O(N^2)</td><td>O(N)</td><td>No</td><td>Yes</td></tr><tr><td>Quick Sort</td><td>O(NlogN)</td><td>O(N^2)</td><td>O(1)</td><td>No</td><td>No</td></tr><tr><td>3-Way Quick Sort</td><td>O(NlogN)</td><td>O(N^2)</td><td>O(1)</td><td>Yes</td><td>No</td></tr><tr><td>Heap Sort</td><td>O(NlogN)</td><td>O(NlogN)</td><td>O(1)</td><td>No</td><td>No</td></tr></tbody></table><h2 id="Binary-Search-Trees"><a href="#Binary-Search-Trees" class="headerlink" title="Binary Search Trees"></a>Binary Search Trees</h2><p>A Binary Search Tree is a Binary Tree in Symmetric Order. Meaning: each node has a key, that’s larger than all keys in its left subtree, but smaller than all keys in its right subtree.</p><p><strong>Search</strong>: Searching in Binary Search Tree is intuitive: if search key is less than node, go left, if greater, go right, if equal, search hit.</p><p>Search in Binary Tree has average time complexity of O(logN) for N elements.</p><p><strong>Insert</strong>: Inserting in Binary Search Tree is similar to search. It keeps finding in the tree until see NULL node.</p><p>Both Search Insertion requires O(logN) of time in average, but could be O(N) in worst case when the tree is unbalanced (e.g. The tree is inserted in sequential order).</p><p><strong>Deletion</strong>: One famous deletion technique for Binary Search Tree is the <a href="http://algs4.cs.princeton.edu/32bst/" target="_blank" rel="noopener">Hibbard deletion</a>. As Hibbard deletion describes, when deleting:</p><ul><li><strong>Node with one child:</strong> Delete the node and replace it with its child.</li><li><strong>Node with two children:</strong><ul><li>Find the node t to delete.</li><li>Find successor x of t, so that x has no left child (the min in t’s right subtree).</li><li>Put x in t’s spot.</li></ul></li></ul><p>See below:</p><p><img src="bst-delete.png" alt="BST deletion"></p><p>Deletion is said to have O(sqrt(N)) average time complexity (From course slides), but still suffers from performance worsening when the tree is unbalanced. One way to tackle this issue is to use a Balanced Search Tree, as described below.</p><h2 id="Balanced-Search-Trees"><a href="#Balanced-Search-Trees" class="headerlink" title="Balanced Search Trees"></a>Balanced Search Trees</h2><h3 id="2-3-Search-Trees"><a href="#2-3-Search-Trees" class="headerlink" title="2-3 Search Trees"></a>2-3 Search Trees</h3><p>2-3 Tree has the following properties:</p><ul><li>Allow 1 or 2 keys per node.<ul><li>2-node: 1 key, 2 children.</li><li>3-node: 2 keys, 3 children.</li></ul></li><li>In symmetric order.</li><li>Perfect balance: every path from root to null link has same length.</li></ul><p>2-3 Tree is designed to keep the tree perfectly balanced, since all its transformation keeps the tree symmetric.</p><p><strong>Insertion for 2-3 Search Tree:</strong></p><ul><li>Search and find the node to insert in, as in Binary Search Tree.</li><li>If the node is a 2 node, then insert the key to make it a 3 node.</li><li>If the node is a 3 node, then insert the key to make it a temp 4 node, then:<ul><li>Split the 4 node, percolate the middle node up to the parent.</li><li>Split the rest 2 keys as two separate 2 nodes.</li><li>If the parent becomes 4 node, recursively split the parent node in the same way.</li></ul></li></ul><p>As shown below:</p><p><img src="23tree-insert3c.png" alt="2-3 Tree Insertion to 3 Node"></p><p>The idea for 2-3 Tree is a beautiful idea, but complicated in implementation. So there are variations and derivations of implementations. Red-Black Tree is one of them.</p><h3 id="Red-Black-Trees"><a href="#Red-Black-Trees" class="headerlink" title="Red-Black Trees"></a>Red-Black Trees</h3><p>One variation of Red-Black Tree discussed in the course is called the Left-Leaning Red-Black Tree. (Guibas-Sedgewick 1979 and Sedgewick 2007, and Sedgewick is the instructor of this online course!)</p><p>LLRBT uses a red node to represent the glue for 3-nodes in 2-3 Tree. Therefore it has the following properties:</p><ul><li>No node has two red links connected to it.</li><li>Every path from root to null link has the same number of black links. (Because the corresponding 2-3 Tree is balanced.)</li><li>Red links lean left.</li></ul><p>To understand the operations in LLRBT, we can build all operations with the following basic operations:</p><ul><li><strong>Left Rotation:</strong> Orient a temporarily right-leaning red link to lean left.  as follows:  <img src="redblack-left-rotate.png" alt="Left Rotate In LLRBT"></li><li><strong>Right Rotation:</strong> Same as Left Rotation, rotate node to the right.</li><li><strong>Color Flip:</strong> If a node has two red children, flip the color of children to black and mark itself red.</li></ul><p>And with these basic transformations, we can operate with insertion on the LLRBT, in case of following scenarios:</p><ul><li><strong>Inserting into a single node</strong> (A 2 node in 2-3 Tree):<ul><li><strong>Insert to the left:</strong> Add to the left, and mark the new node red.</li><li><strong>Insert to the right:</strong> Add to the right, and since there’s a right-leaning red link, left rotate its parent node, to make the parent a left-leaning red node.</li></ul></li><li><strong>Inserting into a 3 node</strong>:<ul><li><strong>To the left of a 3 node:</strong> This makes its parent in the middle of two left leaning red links. Right rotate the parent node, and flip color.</li><li><strong>To the center of a 3 node:</strong> This makes its parent in the middle of a two red links, the parent node is left leaning, and the inserted node is left leaning. Left rotate the parent node, then right flip the inserted node, then flip color.</li><li><strong>To the right of a 3 node:</strong> This makes the parent has two red children, then flip color.</li></ul></li></ul><p>As the graph shows:</p><p><img src="LLRBT_insert_3node.png" alt="Basic operations for inserting into 3-node in LLRBT"></p><p>Although the operations in each cases look really complicated, the actual code could be made concise and elegant using with recursion. To keep in mind that all these operations are used to guarantee that the tree is fully balanced, and there are no right leaning red links.</p><p>The Java example for inserting in LLRBT from the course slide is shown as follows. The insertion searches in the tree for appropriate insert position, and add a new red node at the end. Then determine if the node is violating the properties for LLRBT (Right leaning red node? Two consecutive red links? …), and operate on the node accordingly.</p><p>Code example for LLRBT insertion in Java:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Node <span class="title">put</span><span class="params">(Node h, Key key, Value val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (h == NULL) <span class="keyword">return</span> <span class="keyword">new</span> Node(key, val, RED);</span><br><span class="line">    <span class="keyword">int</span> cmp = key.compareTo(h.key);</span><br><span class="line">    <span class="keyword">if</span>      (cmp &lt; <span class="number">0</span>) h.left = put(h.left, key, val);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>) h.right = put(h.right, key, val);</span><br><span class="line">    <span class="keyword">else</span>              h.val = val;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isRed(h.right) &amp;&amp; !isRed(h.left))    h = rotateLeft(h);</span><br><span class="line">    <span class="keyword">if</span> (isRed(h.left) &amp;&amp; isRed(h.left.left)) h = rotateRight(h);</span><br><span class="line">    <span class="keyword">if</span> (isRed(h.left) &amp;&amp; !isRed(h.right))    flipColors(h);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Symbol-Tables-And-Hash-Tables"><a href="#Symbol-Tables-And-Hash-Tables" class="headerlink" title="Symbol Tables And Hash Tables"></a>Symbol Tables And Hash Tables</h2><p>The Symbol Table, again, is an abstract data type, which maps from keys to values. It supports operations of insertion, deletion, search by key, and etc.. It’s commonly implemented with Hash Tables, which is used everywhere. Some languages have built-in support for Hash Tables.</p><h3 id="Hash-Table"><a href="#Hash-Table" class="headerlink" title="Hash Table"></a>Hash Table</h3><p>Hash Table is a key-indexed table, that maps from its keys to value, and index is a function of the key (hashing function).</p><p>The ideal scenario is that the index distributed uniformly in the hashing index, so that the access to each element requires O(1) time. Somehow when there are collisions, there are two ways to resolve collisions.</p><p><strong>Separate Chaining:</strong> For separate chaining, each collision is stored under the same index, but uses a linked-list to store all the elements under the same index.</p><p><strong>Open Addressing:</strong> In case of a collision, the Hash Table probes the array for the next available position of inserting. There are more than one way to find the next available slot:</p><ul><li>Linear Probing.</li><li>Quadratic Probing.</li><li>Double Hashing.</li></ul><p>While for linear probing, when the array gets too full, the performance for searching and insertion degrades drastically. It keeps relatively good performance when the array is under 50% full.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Finally! Just finished all the lecture videos of “Algorithm I” from Coursera, and I believe now it’s a good time to review and summarize.
    
    </summary>
    
      <category term="Algorithm" scheme="https://blog.kevinhu.me/categories/Algorithm/"/>
    
    
      <category term="Algorithm" scheme="https://blog.kevinhu.me/tags/Algorithm/"/>
    
  </entry>
  
  <entry>
    <title>Paper Reading - Fundamental Concepts In Programming Languages</title>
    <link href="https://blog.kevinhu.me/2015/01/03/Paper-Reading-Fundamental-Concepts-In-Programming-Languages/"/>
    <id>https://blog.kevinhu.me/2015/01/03/Paper-Reading-Fundamental-Concepts-In-Programming-Languages/</id>
    <published>2015-01-03T06:14:06.000Z</published>
    <updated>2018-03-25T21:29:55.725Z</updated>
    
    <content type="html"><![CDATA[<p>This is a holiday reading summary. I recently came across two interesting blogs on fundamental concepts in computer science, both with the title “10 Papers Every Programmer Should Read (At Least Twice)”. One could be found in <a href="http://web.archive.org/web/20121024173845/http:/blog.objectmentor.com/articles/2009/02/26/10-papers-every-programmer-should-read-at-least-twice" target="_blank" rel="noopener">here</a>, and another one in <a href="http://blog.fogus.me/2011/09/08/10-technical-papers-every-programmer-should-read-at-least-twice/" target="_blank" rel="noopener">Fogus’ blog</a>. Topics of these papers range from Programming Language theories, functional programming, to Lamport’s distributed system theories. I will read and summarize some of them in my blog. It’ll be 20 papers, and 40 paper-readings to do if I do read each one twice. So, it might be a long time before all is finished.<a id="more"></a>The first one I chose is “Fundamental Concepts In Programming Languages” (<a href="https://github.com/papers-we-love/papers-we-love/blob/master/plt/fundamental-concepts-in-programming-languages.pdf?raw=true" target="_blank" rel="noopener">Link To Paper</a>). It’s probably the most influential set of lecture notes in computer science, compiled to paper by <a href="http://en.wikipedia.org/wiki/Christopher_Strachey" target="_blank" rel="noopener">Christopher Strachey</a> in 1967, two years before the development of C programming language. Left and Right-values, Parametric and Ad-hoc polymorphism were all defined in this paper.</p><p>I will only try to summarize some highlights that I find interesting.</p><h2 id="L-values-and-R-values"><a href="#L-values-and-R-values" class="headerlink" title="L-values and R-values"></a>L-values and R-values</h2><p>Light and Right-values, also L and R-values. As their names suggest, L-value is for address-like object appropriate on the left of an assignment, R-value is for the contents-like object appropriate for the right. An L-value is for a location in memory, which has content – an associated R-value.</p><p>A name in program (or ‘identifier’) is associated with an L-value, and the association cannot be changed by any assignment. For example, in:</p><pre><code>let p = 3.5</code></pre><p>In this statement, an available location in memory is setup as the L-value of <code>p</code>, and the R-value 3.5 is assigned to this location.</p><p>Somehow, multiple names could have same L-value, by assigning reference to other names. This is slightly different than the concept of pointers, which represents a location by R-value, explained in the paper:</p><blockquote><p>Suppose X is a real variable with L-value a, then P is an object whose R-value is a, we say the type of P is real pointer and that P ‘points to’ X.</p></blockquote><p>The L and R-value should also be specified for the function parameter calling modes, namely, calling a parameter by value (R-value) or reference (L-value). Free variables should also be defined as L-value or R-value, the difference can be shown by the following example.</p><pre><code>Free variable by R-valuelet a = 3let f[x] = x + a... (f[5] = 8)a := 10... (f[5] = 8) Free variable by L-value let a = 3 let f[x] = x + a ... (f[5] = 8) a := 10 ... (f[5] = 15)</code></pre><h2 id="Function-and-routines-as-data-items"><a href="#Function-and-routines-as-data-items" class="headerlink" title="Function and routines as data items"></a>Function and routines as data items</h2><p>First and second class objects are described as following:</p><blockquote><p>In ALGOL a real number may appear in an expression or be assigned to a variable, and either may appear as an actual parameter in a procedure call. A procedure, on the other hand, may only appear in another procedure call either as the operator (the most common case) or as one of the actual parameters. There are no expressions involving procedures or whose results are procedures. Thus in a sense in ALGOL are second class citizens…</p></blockquote><p>To represent functions as data items, we need to make sure the R-value of a function. It includes two parts – a rule for evaluating the expression, and an environment which supplies its free variables. An R-value of this sort will be called a closure.</p><h2 id="Types-and-Polymorphism"><a href="#Types-and-Polymorphism" class="headerlink" title="Types and Polymorphism"></a>Types and Polymorphism</h2><p>In the paper, it describes:</p><blockquote><p>“The type of an object determines its representation and constrains the range of abstract object it may be used to represent.”</p></blockquote><p>Whether the type is an attribute of an L-value or an R-value is language dependent, and can largely affect the amount of work. L-values are invariant under assignment, so their type is also invariant. And if we can determine the type of a polymorphism operator and the result from the operands, we can these attribute <strong>manifest</strong>. Attributes that can only be determined by running the program are known as <strong>latent</strong>.</p><p>Polymorphism is the provision of a single interface to entities of different types. (Definition from <a href="http://en.wikipedia.org/wiki/Polymorphism_(computer_science" target="_blank" rel="noopener">Wikipedia</a>)). In this paper two modes of polymorphism is defined:</p><p><strong>Ad-hoc Polymorphism:</strong> It describes that functions could apply to arguments of different types, and can behave differently depending on the type of arguments. A good example could be the add (+) operand in some languages:</p><pre><code>3 + 5&quot;Hello&quot; + &quot; &quot; + &quot;World&quot;</code></pre><p>In the example above, (+) acts with different meanings. First is the adding of two integers, while the second is the concatenation of strings.</p><p><strong>Parametric Polymorphism</strong>: Parametric Polymorphism act the same regardless of the type. It treats the argument as a more generalized type. This makes the language more flexible while not breaking its static type-safety. A good example will be list operations. For example, to determine the length of a list one need not to know the data type of the list objects, and could therefore it could act on list of all types.</p><h2 id="Afterthoughts"><a href="#Afterthoughts" class="headerlink" title="Afterthoughts"></a>Afterthoughts</h2><p>There are other interesting topics in the paper as well. After learning all these concepts from programming languages, it’s sometimes interesting and necessary to learn the origins, to know how these ideas first came into formation. Putting the trivias of different language syntax aside for a while and getting back to theories actually helps understanding their designs.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;This is a holiday reading summary. I recently came across two interesting blogs on fundamental concepts in computer science, both with the title “10 Papers Every Programmer Should Read (At Least Twice)”. One could be found in &lt;a href=&quot;http://web.archive.org/web/20121024173845/http:/blog.objectmentor.com/articles/2009/02/26/10-papers-every-programmer-should-read-at-least-twice&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;here&lt;/a&gt;, and another one in &lt;a href=&quot;http://blog.fogus.me/2011/09/08/10-technical-papers-every-programmer-should-read-at-least-twice/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Fogus’ blog&lt;/a&gt;. Topics of these papers range from Programming Language theories, functional programming, to Lamport’s distributed system theories. I will read and summarize some of them in my blog. It’ll be 20 papers, and 40 paper-readings to do if I do read each one twice. So, it might be a long time before all is finished.
    
    </summary>
    
      <category term="ProgrammingLanguage" scheme="https://blog.kevinhu.me/categories/ProgrammingLanguage/"/>
    
    
      <category term="ProgrammingLanguage" scheme="https://blog.kevinhu.me/tags/ProgrammingLanguage/"/>
    
      <category term="PaperReading" scheme="https://blog.kevinhu.me/tags/PaperReading/"/>
    
  </entry>
  
  <entry>
    <title>What Parsers Are They Using?</title>
    <link href="https://blog.kevinhu.me/2014/11/24/24-what-parsers-are-they-using/"/>
    <id>https://blog.kevinhu.me/2014/11/24/24-what-parsers-are-they-using/</id>
    <published>2014-11-24T23:29:00.000Z</published>
    <updated>2018-03-25T21:29:55.765Z</updated>
    
    <content type="html"><![CDATA[<p>This is a <del>quite boring</del> post on programming language trivia, which doesn’t dig into anything deep.</p><h2 id="GCC-and-Clang"><a href="#GCC-and-Clang" class="headerlink" title="GCC and Clang"></a>GCC and Clang</h2><p>The GCC is mostly implemented in C, and used to use Bison for parser generation, according to its <a href="http://en.wikipedia.org/wiki/GNU_bison" target="_blank" rel="noopener">Wikipedia page</a>.By default, it generates right recursive table driven LALR parser.<a id="more"></a></p><p>Somehow according to the <a href="http://en.wikipedia.org/wiki/GNU_bison#Where_is_it_used.3F" target="_blank" rel="noopener">same page</a>, GCC has switched to <a href="http://dinosaur.compilertools.net/yacc/" target="_blank" rel="noopener">YACC</a> before now switching to a hand-written recursive-descent parser for C/C++/Objective C. This could also be seen from GCC release notes <a href="https://gcc.gnu.org/gcc-3.4/changes.html#cplusplus" target="_blank" rel="noopener">3.4</a> and <a href="https://gcc.gnu.org/gcc-4.1/changes.html" target="_blank" rel="noopener">4.1</a>. </p><p>Clang, as well as LLVM is implemented in C++. It also uses a unified recursive-descent parser for C, Objective C, C++ and Objective C++, according to the <a href="http://clang.llvm.org/features.html" target="_blank" rel="noopener">LLVM Clang Page</a>. Both GCC and Clang now uses recursive-descent parser, claiming it provides with faster speed. On Clang page, it also states recursive-descent parser:</p><blockquote><p> … makes it very easy for new developers to understand the code, it easily supports ad-hoc rules and other strange hacks required by C/C++, and makes it straight-forward to implement excellent diagnostics and error recovery.</p></blockquote><h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><p>Here Python refers to the CPython implementation. In its repo under <a href="https://github.com/python/cpython/tree/master/Parser" target="_blank" rel="noopener">“Parser” directory</a>, it could be seen CPython actually uses <a href="http://asdl.sourceforge.net/" target="_blank" rel="noopener">Zephyr ASDL</a> for syntax description. Zyphyr ASDL is also described in its <a href="https://www.cs.princeton.edu/research/techreps/TR-554-97" target="_blank" rel="noopener">Princeton CS Dept. Page</a>.</p><p>Python uses LL(1) grammar. Its AST file (Python-ast.c) isgenerated according to the ASDL description of the language. The detailed process is described in <a href="http://legacy.python.org/dev/peps/pep-0339/" target="_blank" rel="noopener">PEP339</a>.</p><h2 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h2><p>Ruby MRI is implemented in C. According to <a href="http://en.wikipedia.org/wiki/GNU_bison#Where_is_it_used.3F" target="_blank" rel="noopener">Bison Wikipedia Page</a>, Ruby also uses Bison for the parser generation, which should be a right-recursive parser. </p><p>The source code for parser and syntax could be found in <a href="https://github.com/ruby/ruby/blob/trunk/parse.y" target="_blank" rel="noopener">its repo</a>.</p><h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><p>JavaScript v8 is implemented in C++. It claims to be using a hand-written top-down parser, according to <a href="http://www.quora.com/What-are-the-parsing-techniques-used-by-modern-compilers" target="_blank" rel="noopener">this Quora post</a>.</p><p>I have no time to dig in its code base at the moment. Also it’s not in the scope of this post.</p><h2 id="Haskell"><a href="#Haskell" class="headerlink" title="Haskell"></a>Haskell</h2><p>According to the <a href="http://www.quora.com/What-are-the-parsing-techniques-used-by-modern-compilers" target="_blank" rel="noopener">Quora post above</a>, GHC uses a generator called <a href="https://www.haskell.org/happy/" target="_blank" rel="noopener">Happy</a>. From its official website, it looks like it’s first created to generate parser specifically for GHC.</p><p>Its syntax is defined in its codebase directory <a href="https://github.com/ghc/ghc/tree/master/compiler/parser" target="_blank" rel="noopener">“compiler/parser/Parser.y”</a>.</p><h2 id="Julia"><a href="#Julia" class="headerlink" title="Julia"></a>Julia</h2><p>Interestingly, after searching a while in its <a href="https://github.com/JuliaLang/julia/tree/master/src" target="_blank" rel="noopener">GitHub codebase</a>, I found that Julia actually uses Scheme for itsfrontend and parser. Although most its other source files are in C.</p><p>It looks like it also uses a recursive-descent parser.</p><h2 id="Golang"><a href="#Golang" class="headerlink" title="Golang"></a>Golang</h2><p>Golang parser is now implemented in Golang itself now. (Wow!) Not only that, most Golang implementation is in Go, according to its <a href="https://github.com/jnwhiteh/golang" target="_blank" rel="noopener">Github mirror repo</a>. By the time I checked it, it contains 75.7% Golang, 19.4% C, 3.0% Assembly, and 1.9% other.</p><p>From its parser <a href="https://github.com/jnwhiteh/golang/blob/master/src/go/parser/parser.go" target="_blank" rel="noopener">source code</a>, it looks like it also uses a recursive-descent parser.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;This is a &lt;del&gt;quite boring&lt;/del&gt; post on programming language trivia, which doesn’t dig into anything deep.&lt;/p&gt;
&lt;h2 id=&quot;GCC-and-Clang&quot;&gt;&lt;a href=&quot;#GCC-and-Clang&quot; class=&quot;headerlink&quot; title=&quot;GCC and Clang&quot;&gt;&lt;/a&gt;GCC and Clang&lt;/h2&gt;&lt;p&gt;The GCC is mostly implemented in C, and used to use Bison for parser generation, according to its &lt;a href=&quot;http://en.wikipedia.org/wiki/GNU_bison&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Wikipedia page&lt;/a&gt;.
By default, it generates right recursive table driven LALR parser.
    
    </summary>
    
      <category term="ProgrammingLanguage" scheme="https://blog.kevinhu.me/categories/ProgrammingLanguage/"/>
    
    
  </entry>
  
  <entry>
    <title>More On Passwd</title>
    <link href="https://blog.kevinhu.me/2014/10/31/31-more-on-passwd/"/>
    <id>https://blog.kevinhu.me/2014/10/31/31-more-on-passwd/</id>
    <published>2014-11-01T02:30:45.000Z</published>
    <updated>2018-03-25T21:29:55.801Z</updated>
    
    <content type="html"><![CDATA[<p>A little bit more interesting discoveries while digging into the passwd code file.</p><h2 id="The-‘s’-flag-in-file-permission"><a href="#The-‘s’-flag-in-file-permission" class="headerlink" title="The ‘s’ flag in file permission"></a>The ‘s’ flag in file permission</h2><p>First, the file permission of passwd executable is <code>-rwsr-xr-x</code>. There’s an ‘s’ flag which don’t usually appear in common Unix files. The usage of the ‘s’ field is explained here:</p><p><a href="http://en.wikipedia.org/wiki/Setuid" target="_blank" rel="noopener">http://en.wikipedia.org/wiki/Setuid</a></p><a id="more"></a><p>Which means when a user runs the passwd program, his effective uid will become the owner of the executable file, which is root in this case. While inside the passwd program, it uses <code>getuid</code>, which returns the user’s real id instead of effective id.</p><h2 id="On-updating-the-shadow-file"><a href="#On-updating-the-shadow-file" class="headerlink" title="On updating the shadow file"></a>On updating the shadow file</h2><p>I also do notice that the whole passwd program would only require one Unix system capability: the <code>CAP_FCHOWN</code> capability, which is required when you’re changing the owner of one file. Here’s why the program needs it.</p><p>As a matter of fact, the passwd program never actually directly writes into the <code>/etc/shadow</code> file. For some reason (perhaps security concerns), it writes into a temp file first, set the uid and gid of the temp file, and then rewrite the shadow file with the temp file.</p><p>The code is defined in <code>commonio.c</code> file, <code>commonio_update</code> function. As described in the code bellow:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// set the temp filename</span></span><br><span class="line"><span class="built_in">snprintf</span> (buf, <span class="keyword">sizeof</span> buf, <span class="string">"%s+"</span>, db-&gt;filename);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// open the file with name defined in buf, permissions defined in sb, returns the file pointer</span></span><br><span class="line">db-&gt;fp = fopen_set_perms (buf, <span class="string">"w"</span>, &amp;sb);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// write all data to db-&gt;fp, the temp fp</span></span><br><span class="line"><span class="keyword">if</span> (write_all (db) != <span class="number">0</span>)&#123;...&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// Rename the temp filename in buf to db-&gt;filename, which is /etc/shadow</span></span><br><span class="line"><span class="keyword">if</span> (lrename (buf, db-&gt;filename) != <span class="number">0</span>)&#123;...&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Written with <a href="https://stackedit.io/" target="_blank" rel="noopener">StackEdit</a>.</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;A little bit more interesting discoveries while digging into the passwd code file.&lt;/p&gt;
&lt;h2 id=&quot;The-‘s’-flag-in-file-permission&quot;&gt;&lt;a href=&quot;#The-‘s’-flag-in-file-permission&quot; class=&quot;headerlink&quot; title=&quot;The ‘s’ flag in file permission&quot;&gt;&lt;/a&gt;The ‘s’ flag in file permission&lt;/h2&gt;&lt;p&gt;First, the file permission of passwd executable is &lt;code&gt;-rwsr-xr-x&lt;/code&gt;. There’s an ‘s’ flag which don’t usually appear in common Unix files. The usage of the ‘s’ field is explained here:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Setuid&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://en.wikipedia.org/wiki/Setuid&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="CodeReading" scheme="https://blog.kevinhu.me/categories/CodeReading/"/>
    
    
      <category term="Password" scheme="https://blog.kevinhu.me/tags/Password/"/>
    
      <category term="CodeReading" scheme="https://blog.kevinhu.me/tags/CodeReading/"/>
    
  </entry>
  
  <entry>
    <title>A Dive Into Password</title>
    <link href="https://blog.kevinhu.me/2014/10/13/13-a-dive-into-password/"/>
    <id>https://blog.kevinhu.me/2014/10/13/13-a-dive-into-password/</id>
    <published>2014-10-14T02:08:55.000Z</published>
    <updated>2018-03-25T21:29:55.929Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Passwd"><a href="#Passwd" class="headerlink" title="Passwd"></a>Passwd</h2><p>The passwd is program on Unix systems to manage users’ passwords. The user and password information on most Unix systems is stored in two separate files: /etc/passwd for user information, and /etc/shadow for password information, including encrypted password value, expiration data, UID, GID, and etc.. Therationale behind storing information in separate files is discussed in <a href="http://www.tldp.org/HOWTO/Shadow-Password-HOWTO-2.html" target="_blank" rel="noopener">Why shadow your passwd file?</a><a id="more"></a></p><p>The passwd program is a part of the shadow-utils, which includes a series of programs to manage user accounts, group accounts, and converting plain passwords to shadow password format, such as: groupadd, useradd, usermod, login, passwd, su, and etc..</p><p>The source file of <code>passwd</code> is available in <a href="http://pkg-shadow.alioth.debian.org/" target="_blank" rel="noopener">Debian Alioth Page</a> and <a href="https://packages.debian.org/source/wheezy/shadow" target="_blank" rel="noopener">Debian Package Information Page</a>. I downloaded the 4.1.5 original source for my study. See opensource isn’t just a campaign slogan, it’s something real!</p><p>Basically, what passwd does is to manage passwords, like updating passwords,  setting minimum and maximum password expiration date, and all these information is saved to the /etc/passwd and /etc/shadow files, and password information in particular, needs an encryption library for protection, instead of being saved as plain text.</p><p>Below is a <strong>NON</strong>-comprehensive list of code files required by the passwd program in the shadow-utils code base:</p><pre>src/passwd.clib/defines.hlib/getdef.(h/c)lib/shadow.(h/c)lib/shadowio.(h/c)lib/commonio.(h/c)lib/sgetspent.c</pre><h2 id="How-we-change-our-password"><a href="#How-we-change-our-password" class="headerlink" title="How we change our password"></a>How we change our password</h2><h3 id="Data-structure-definitions-first"><a href="#Data-structure-definitions-first" class="headerlink" title="Data structure definitions first?"></a>Data structure definitions first?</h3><ul><li><strong>Shadow passwd struct</strong>:Defined in shadow.h in linux include directory. Defines the structure of the shadow file. The pointer in the main function is defined as:</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">struct</span> spwd *sp;  <span class="comment">/* Shadow file entry for user   */</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">/* Structure of the password file.  */</span></span><br><span class="line"><span class="keyword">struct</span> spwd</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">char</span> *sp_namp;              <span class="comment">/* Login name.  */</span></span><br><span class="line">    <span class="keyword">char</span> *sp_pwdp;              <span class="comment">/* Encrypted password.  */</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">int</span> sp_lstchg;         <span class="comment">/* Date of last change.  */</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">int</span> sp_min;            <span class="comment">/* Minimum number of days between changes.  */</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">int</span> sp_max;            <span class="comment">/* Maximum number of days between changes.  */</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">int</span> sp_warn;           <span class="comment">/* Number of days to warn user to change</span></span><br><span class="line"><span class="comment">    the password.  */</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">int</span> sp_inact;          <span class="comment">/* Number of days the account may be</span></span><br><span class="line"><span class="comment">    inactive.  */</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">int</span> sp_expire;         <span class="comment">/* Number of days since 1970-01-01 until</span></span><br><span class="line"><span class="comment">    account expires.  */</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> sp_flag;  <span class="comment">/* Reserved.  */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><p><strong>Passwd Structure</strong>:Defined in pwd.h in linux include directory. Defines the <code>/etc/passwd</code> file structure. The pointer in the main function is defined:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">struct</span> passwd *pw;  <span class="comment">/* Password file entry for user      */</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">/* The passwd structure.  */</span></span><br><span class="line"><span class="keyword">struct</span> passwd</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">char</span> *pw_name;                <span class="comment">/* Username.  */</span></span><br><span class="line">    <span class="keyword">char</span> *pw_passwd;              <span class="comment">/* Password.  */</span></span><br><span class="line">    <span class="keyword">__uid_t</span> pw_uid;               <span class="comment">/* User ID.  */</span></span><br><span class="line">    <span class="keyword">__gid_t</span> pw_gid;               <span class="comment">/* Group ID.  */</span></span><br><span class="line">    <span class="keyword">char</span> *pw_gecos;               <span class="comment">/* Real name.  */</span></span><br><span class="line">    <span class="keyword">char</span> *pw_dir;                 <span class="comment">/* Home directory.  */</span></span><br><span class="line">    <span class="keyword">char</span> *pw_shell;               <span class="comment">/* Shell program.  */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p><strong>Shadow_db structure</strong>: Defined in <code>lib/shadowio.c</code>. It’s a doubly linked list, storing information for all the shadow file entries. It’s declared with a type called <code>struct commonio_db</code>, defined in <code>commonio.h</code>.</p><p>  Shadow library has <code>commonio.c</code> for all the common io data structures and operations, and <code>shadowio.c</code>, which could be seen as a wrapper around common io for all shadow file data structure and operations.</p><p>  The <code>shadow_db</code> defined as below. The <code>SHADOW_FILE</code> as you might have already guessed, is a macro defined as <code>“/etc/shadow”</code>.</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">struct</span> commonio_db shadow_db = &#123;</span><br><span class="line">    SHADOW_FILE,            <span class="comment">/* filename */</span></span><br><span class="line">    &amp;shadow_ops,            <span class="comment">/* ops */</span></span><br><span class="line">    <span class="literal">NULL</span>,                   <span class="comment">/* fp */</span></span><br><span class="line">    #ifdef WITH_SELINUX</span><br><span class="line">    <span class="literal">NULL</span>,                   <span class="comment">/* scontext */</span></span><br><span class="line">    #endif</span><br><span class="line">    <span class="literal">NULL</span>,                   <span class="comment">/* head */</span></span><br><span class="line">    <span class="literal">NULL</span>,                   <span class="comment">/* tail */</span></span><br><span class="line">    <span class="literal">NULL</span>,                   <span class="comment">/* cursor */</span></span><br><span class="line">    <span class="literal">false</span>,                  <span class="comment">/* changed */</span></span><br><span class="line">    <span class="literal">false</span>,                  <span class="comment">/* isopen */</span></span><br><span class="line">    <span class="literal">false</span>,                  <span class="comment">/* locked */</span></span><br><span class="line">    <span class="literal">false</span>                   <span class="comment">/* readonly */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>Some important global variables<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> *name;   <span class="comment">/* The name of user whose password is being changed */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> *myname; <span class="comment">/* The current user's name */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">bool</span> amroot;  <span class="comment">/* The caller's real UID was 0 */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> crypt_passwd[<span class="number">256</span>];</span><br></pre></td></tr></table></figure></li></ul><h3 id="Main-function"><a href="#Main-function" class="headerlink" title="Main function"></a>Main function</h3><p>Though the whole password update procedure could be simply described as “reading and updating the <code>/etc/passwd</code> and <code>/etc/shadow</code> file”, the shadow library uses piles of code to check identity, permission, and several layers of function calls for encryption, and finally updating files. It needs to consider every aspect of the problem, which makes the code size larger than you  might expect.</p><p>Also, passwd libray took <a href="http://www.wikiwand.com/en/Linux_PAM" target="_blank" rel="noopener">PAM</a>, <a href="http://www.wikiwand.com/en/Trusted_computing_base" target="_blank" rel="noopener">TCB</a> and <a href="http://www.wikiwand.com/en/Security-Enhanced_Linux" target="_blank" rel="noopener">SELinux</a> into considerations. I would skip these here for I don’t yet have time to study all.</p><p>A good place to start reading is the <code>main()</code> entry of the <code>passwd.c</code>. The procedures could be summarized as follows:</p><ul><li><strong>Initialization</strong>:Init data structures (<code>const struct passwd <em>pw</em></code>, <code>const struct spwd sp</code>, etc.), sanitize environment, check if the user is root, …;</li><li><strong>Parse parameters</strong>:A large switch case for all parameters. As I’m now only interested in updating my password, I would follow the execution path where no parameters are given;</li><li><strong>Get username, check permissions</strong>:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pw = get_my_pwent();</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span> (!amroot &amp;&amp; (pw-&gt;pw_uid!=getuid()))&#123;...&#125;</span><br><span class="line">...</span><br><span class="line">sp = getspnam(name);</span><br><span class="line">...</span><br><span class="line">check_password(pw, sp);</span><br></pre></td></tr></table></figure></li></ul><p>Get username, init pw and sp data structures, check if the user is root or if the user is trying to change his own password. Then it checks the validity of the user’s account: is it expired, is its min password change time reached? These are in <code>check_password()</code> function.</p><ul><li><strong>Get new password</strong>:</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (new_password(pw) != <span class="number">0</span>)&#123;...&#125;</span><br></pre></td></tr></table></figure><p>Here’s where there’s most fun. It’ when the <code>passwd</code> program prompts you for your old password, and tell you to input your new password. If you fail in trying too many times, the program would get upset and refuses to update password for you.Under the hood, it also does the following things:</p><ul><li>Encrypt your input with <code>pw_encrypt()</code>(defined in <code>lib/encrypt.c</code>), then compare it with the old encrypted string. There must be a lot of fun to dig into the encryption method, but it’s not in the scope of this blog;</li><li>Warns you of weak password;</li><li><p>Encrypt the password then immediately wipe the cleartext password, saves the encrypted password to the global variable <code>crypt_passwd</code>, which would then copied to other data structures, and then saves to the shadow file.</p></li><li><p><strong>Update shadow file</strong>:</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update_shadow();</span><br></pre></td></tr></table></figure><p>The program warns you the username you are changing password, then it calls the <code>update_shadow()</code> if you have shadow file. Otherwise, it calls <code>update_noshadow()</code>.</p><p>The <code>update_shadow()</code> is going to the core of the program, and it’s what I will observe closely.</p><h3 id="update-shadow-function"><a href="#update-shadow-function" class="headerlink" title="update_shadow() function"></a>update_shadow() function</h3><p>Function <code>update_shadow()</code> is defined in <code>src/passwd.c</code>, and the summary of the procedures is:</p><ul><li><strong>Set a global lock</strong>:</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (spw_lock() == <span class="number">0</span>)&#123;...&#125;</span><br></pre></td></tr></table></figure><p>Lock the shadow password file access. Spit an error if it’s already locked.</p><ul><li><strong>Open the shadow file</strong>:</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (spw_open(O_RDWR)==<span class="number">0</span>)&#123;...&#125;</span><br></pre></td></tr></table></figure><p>Taking a deeper look inside the <code>spw_open</code> in <code>lib/shadowio.c</code>, you could find that here is when it opens up the shadow file, reads it, and stores all the entries to the <code>shadow_db</code> doubly linked list.</p><ul><li><strong>Locate the entry by name</strong>:</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sp = spw_locate (name);</span><br></pre></td></tr></table></figure><p>Also a function call in <code>lib/shadowio.c</code>. The <code>name</code> param is the current username.</p><ul><li><strong>Create nsp Data Structure</strong>:</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nsp = __spw_dup (sp);</span><br></pre></td></tr></table></figure><p>It copies the content in sp to a new pointer nsp;</p><ul><li><strong>Update the encrypted passwd</strong>:</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update_crypt_pw(nsp-&gt;sp_pwdp);</span><br></pre></td></tr></table></figure><p>Finally! The <code>crypted_passwd</code> is copied to the data structure, with:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp=xstrdup(crypt_passwd)</span><br></pre></td></tr></table></figure></p><p>inside of <code>update_crypt_pw()</code> function. This process is hidden so deep.The nsp data structure would then carry this encrypted password to the shadow file. The program would also update metadata, such as the expiration date and so on;</p><ul><li><strong>Update the shadow_db Data Structure</strong>:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (spw_update(nsp) == <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> commonio_update(&amp;shadow_db, (<span class="keyword">const</span> <span class="keyword">void</span> *)sp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>The <code>spw_update()</code>, again is a wrapper for the relating <code>commonio_update()</code>. Inside it would try to find the entry of the <code>shadow_db</code> data structure, or create new entry when not found. Then it saves all the information in the <code>sp</code> to the <code>shadow_db</code>.</p><ul><li><strong>Close the shadow file, unlock the global lock</strong>:*<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spw_close();</span><br><span class="line">...</span><br><span class="line">spw_unlock();</span><br></pre></td></tr></table></figure></li></ul><p>Close and saves the shadow file to its place. Unlock the global lock, concludes the whole process. Still, there’s much interesting things to look at inside the <code>spw_close()</code> and <code>commonio_close()</code>, but I think I’ve written long enough.</p><h2 id="Afterthoughts"><a href="#Afterthoughts" class="headerlink" title="Afterthoughts"></a>Afterthoughts</h2><p>Reading code is fun, recording the whole process is even more so. It’s a rewarding process, especially for some high-quality code as shadow library. It kinda teaches you how top-notch programmers tackles system-level problems. It’s also tiring though, when you dig into all the function calls, variables (especially global variables) while tracking its execution path. At some point I really wish the code could be a little bit more commented.</p><p>I might have the energy to blog all the code I will read, but I think I will definitely read more code before I start writing something similar. To conclude, it’s actually fun experience that quenches your curiosity of “How it actually works”.</p><blockquote><p>Written with <a href="https://stackedit.io/" target="_blank" rel="noopener">StackEdit</a>.</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Passwd&quot;&gt;&lt;a href=&quot;#Passwd&quot; class=&quot;headerlink&quot; title=&quot;Passwd&quot;&gt;&lt;/a&gt;Passwd&lt;/h2&gt;&lt;p&gt;The passwd is program on Unix systems to manage users’ passwords. The user and password information on most Unix systems is stored in two separate files: /etc/passwd for user information, and /etc/shadow for password information, including encrypted password value, expiration data, UID, GID, and etc.. The
rationale behind storing information in separate files is discussed in &lt;a href=&quot;http://www.tldp.org/HOWTO/Shadow-Password-HOWTO-2.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Why shadow your passwd file?&lt;/a&gt;
    
    </summary>
    
      <category term="CodeReading" scheme="https://blog.kevinhu.me/categories/CodeReading/"/>
    
    
      <category term="Password" scheme="https://blog.kevinhu.me/tags/Password/"/>
    
      <category term="CodeReading" scheme="https://blog.kevinhu.me/tags/CodeReading/"/>
    
  </entry>
  
  <entry>
    <title>A Dive Into PLY</title>
    <link href="https://blog.kevinhu.me/2014/10/11/11-a-dive-into-ply/"/>
    <id>https://blog.kevinhu.me/2014/10/11/11-a-dive-into-ply/</id>
    <published>2014-10-12T01:50:24.000Z</published>
    <updated>2018-03-25T21:29:55.584Z</updated>
    
    <content type="html"><![CDATA[<p>I’ve been auditing a course in computer language implementation and particularly interested in parser generator. Just spent an afternoon reading about the Python parser generator <a href="http://www.dabeaz.com/ply/" target="_blank" rel="noopener">PLY</a>. It’s a pure Python Implementation of Lex and Yacc. And <a href="http://www.dabeaz.com/ply/ply.html#ply_nn4" target="_blank" rel="noopener">here</a> is the PLY documentation I’ve been reading the whole afternoon.<a id="more"></a></p><h2 id="PLY-Lex"><a href="#PLY-Lex" class="headerlink" title="PLY Lex"></a>PLY Lex</h2><p>Basically, writing a tokenizer is to generate a finite automata.  It should be easy to implement with the assist of regular expressions. For PLY Lex, the following needs to be defined:</p><ul><li><strong>Tokens</strong>: The token types;</li><li><strong>Token definition</strong>: You can define a token by a variable of regular expression, or a method whose docstring is regular expression definition. Naming convention follows: <code>t_TOKENNAME</code>, e.g. SYMBOL token should be defined by a variable or method with name <code>t_SYMBOL</code>;</li><li><strong>Error method</strong>: define the <code>t_error()</code> method for error handling.</li></ul><p>Finally, run Lex build method to build the tokenizer. If you define all data structure in a class, point the module argument to that class.</p><p>Code listed as following:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyLexer</span>:</span></span><br><span class="line">    tokens = (</span><br><span class="line">    <span class="string">"SYMBOL"</span>,</span><br><span class="line">    <span class="string">"OP"</span>,</span><br><span class="line">    <span class="string">"FIXNUM"</span>,</span><br><span class="line">    <span class="string">"WS"</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    t_SYMBOL = <span class="string">r'[a-zA-Z_]+[a-zA-Z_0-9]+'</span></span><br><span class="line">        t_OP = <span class="string">r'\+|-|\*|/'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">t_WS</span><span class="params">(self, t)</span>:</span></span><br><span class="line">            <span class="string">r'\s+'</span></span><br><span class="line">            <span class="comment"># input t is the input token class</span></span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">t_FIXNUM</span><span class="params">(self, t)</span>:</span></span><br><span class="line">            <span class="string">r'\d+'</span></span><br><span class="line">            t.value = int (t.value)</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">t_newline</span><span class="params">(self, t)</span>:</span></span><br><span class="line">            <span class="string">r'\n+'</span></span><br><span class="line">            <span class="comment"># t.lexer points to the lexer class, which stores info for whole lexer</span></span><br><span class="line">            t.lexer.lineno += len(t.value)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">t_error</span> <span class="params">(self, t)</span>:</span></span><br><span class="line">            <span class="keyword">print</span> (<span class="string">"Illegal"</span>)</span><br><span class="line">            t.lexer.skip (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build</span><span class="params">(self, **kwargs)</span>:</span></span><br><span class="line">            self.lexer = ply.lex.lex(module=self, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span> <span class="params">(self, data)</span>:</span></span><br><span class="line">            self.lexer.input(data)</span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> self.lexer:</span><br><span class="line">            <span class="keyword">print</span> (t)</span><br><span class="line"></span><br><span class="line">m = MyLexer ()</span><br><span class="line"><span class="comment"># build lexer and init data structre</span></span><br><span class="line">m.build ()</span><br><span class="line">m.run (<span class="string">"3 + 4 * 6"</span>)</span><br></pre></td></tr></table></figure></p><h2 id="PLY-Yacc"><a href="#PLY-Yacc" class="headerlink" title="PLY Yacc"></a>PLY Yacc</h2><p>Yacc generates a table-driven LR parser, and LALR(1) by default, SLR when specified.</p><p>Yacc also uses docstring to define Context Free Grammar. Similarly, grammar definition method has naming convention as <code>p_PRODUCT_NAME</code>. It also generates a shift/reduce parser.out output for debugging purpose.</p><p>Yacc allows ambiguous grammar. It can resolve ambiguity by supporting precedence. One example for arithmetic operations from documentation:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">expression : expression PLUS expression</span><br><span class="line">           | expression MINUS expression</span><br><span class="line">           | expression TIMES expression</span><br><span class="line">           | expression DIVIDE expression</span><br><span class="line">           | &apos;(&apos; expression &apos;)&apos;</span><br><span class="line">           | NUMBER</span><br></pre></td></tr></table></figure></p><p>Which creates ambiguity when parsing expressions like</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3 + 4 * 5</span><br></pre></td></tr></table></figure><p>With precedence, Yacc would always know to handle higher precedence operations than lower precedence ones.</p><p>One example (from PLY offical release 3.14 examples) of expression definition with precedence defined:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">precedence = (</span><br><span class="line">    (&apos;left&apos;,&apos;+&apos;,&apos;-&apos;),</span><br><span class="line">        (&apos;left&apos;,&apos;*&apos;,&apos;/&apos;),</span><br><span class="line">            (&apos;right&apos;,&apos;UMINUS&apos;),</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">def p_expression_binop(p):</span><br><span class="line">    &apos;&apos;&apos;expression : expression &apos;+&apos; expression</span><br><span class="line">                  | expression &apos;-&apos; expression</span><br><span class="line">                  | expression &apos;*&apos; expression</span><br><span class="line">                  | expression &apos;/&apos; expression&apos;&apos;&apos;</span><br><span class="line">                  if p[2] == &apos;+&apos;  : p[0] = p[1] + p[3]</span><br><span class="line">                  elif p[2] == &apos;-&apos;: p[0] = p[1] - p[3]</span><br><span class="line">                  elif p[2] == &apos;*&apos;: p[0] = p[1] * p[3]</span><br><span class="line">                  elif p[2] == &apos;/&apos;: p[0] = p[1] / p[3]</span><br></pre></td></tr></table></figure><p>A collection of examples could be found in <a href="https://github.com/dabeaz/ply/tree/master/example" target="_blank" rel="noopener">here</a>.</p><h2 id="Afterthoughts"><a href="#Afterthoughts" class="headerlink" title="Afterthoughts"></a>Afterthoughts</h2><p>PLY is an interesting tool that I want to build something with. There’s also a variation based on PLY called <a href="https://github.com/erezsh/plyplus" target="_blank" rel="noopener">PLYPlus</a> that trys to provide a cleaner interface for programmers. Somehow I have a hunch that it could be done better.</p><p>GCC used to use bison generated parser as frontend, but now it’s using a hand-written recursive-descent parser for performance reasons. So is clang. For language generators as far as I know, Ruby uses Yacc as its parser, and Python uses <a href="http://www.cs.princeton.edu/research/techreps/TR-554-97" target="_blank" rel="noopener">ASDL</a>, which are all worth digging when I have time.</p><p>Somehow I wonder why not very many people claim to use PLY as a tool for language manipulations. It could be quite handy when you consider constructing something  with relatively complex grammar parsing,  requires faster development cycle, and is not performance critical. If I encounter any projects like that in future, I think PLY would be on the top list of my tool selections.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;I’ve been auditing a course in computer language implementation and particularly interested in parser generator. Just spent an afternoon reading about the Python parser generator &lt;a href=&quot;http://www.dabeaz.com/ply/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;PLY&lt;/a&gt;. It’s a pure Python Implementation of Lex and Yacc. And &lt;a href=&quot;http://www.dabeaz.com/ply/ply.html#ply_nn4&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;here&lt;/a&gt; is the PLY documentation I’ve been reading the whole afternoon.
    
    </summary>
    
      <category term="ProgrammingLanguage" scheme="https://blog.kevinhu.me/categories/ProgrammingLanguage/"/>
    
    
      <category term="ProgrammingLanguage" scheme="https://blog.kevinhu.me/tags/ProgrammingLanguage/"/>
    
  </entry>
  
  <entry>
    <title>A New Blog For My Tech Notes</title>
    <link href="https://blog.kevinhu.me/2014/10/08/08-a-new-blog-for-my-tech-notes/"/>
    <id>https://blog.kevinhu.me/2014/10/08/08-a-new-blog-for-my-tech-notes/</id>
    <published>2014-10-09T01:47:44.000Z</published>
    <updated>2018-03-25T21:29:55.755Z</updated>
    
    <content type="html"><![CDATA[<p>Hello World!</p><p>It’s been a while since the last time I ever wrote some serious blog posts. After some thought I now decide to separate my everyday chit-chat blog from a more tech-oriented blog, so that contents from either sides won’t get entwined with each other, especially when I decide to blog in both languages.</p><p>For a more tech-oriented blog I’d like to keep everything in English. For I believe it’s a language most tech people could understand, even in China. And now I could publish all my discoveries, my thoughts, my ideas centered around technology in this blog, and welcome discussions. Blogging is a beautiful way of communication, and hopefully I could make friends with like-minded through keeping this blog.</p><p>And there it goes. A brand new blogging journey!</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hello World!&lt;/p&gt;
&lt;p&gt;It’s been a while since the last time I ever wrote some serious blog posts. After some thought I now decide to separa
      
    
    </summary>
    
      <category term="Diary" scheme="https://blog.kevinhu.me/categories/Diary/"/>
    
    
  </entry>
  
</feed>
